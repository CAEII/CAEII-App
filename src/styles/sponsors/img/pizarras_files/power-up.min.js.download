!function(t){"function"==typeof define&&define.amd?define(t):t()}((function(){"use strict";var t,e="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},r=!!(t=new Error("yep")).stack&&"Error: yep\n"===t.stack.substr(0,11),n=function(t,e,r){var n=e;return r&&(n+=": "+r),t=n+t.slice(t.indexOf("\n"))};var o=function(t,e){function o(e){if(!(this instanceof o))return new o(e);try{throw new Error(e)}catch(e){e.name=t,this.stack=e.stack}r&&this.stack&&(this.stack=n(this.stack,t,e)),this.message=e||"",this.name=t}return o.prototype=new(e||Error),o.prototype.constructor=o,o.prototype.inspect=function(){return this.message?"["+t+": "+this.message+"]":"["+t+"]"},o.prototype.name=t,o};function i(t){if(this._capacity=a(t),this._length=0,this._front=0,s(t)){for(var e=t.length,r=0;r<e;++r)this[r]=t[r];this._length=e}}i.prototype.toArray=function(){for(var t=this._length,e=new Array(t),r=this._front,n=this._capacity,o=0;o<t;++o)e[o]=this[r+o&n-1];return e},i.prototype.push=function(t){var e=arguments.length,r=this._length;if(e>1){var n=this._capacity;if(r+e>n){for(var o=0;o<e;++o){this._checkCapacity(r+1),this[i=this._front+r&this._capacity-1]=arguments[o],r++,this._length=r}return r}for(var i=this._front,o=0;o<e;++o)this[i+r&n-1]=arguments[o],i++;return this._length=r+e,r+e}return 0===e?r:(this._checkCapacity(r+1),this[o=this._front+r&this._capacity-1]=t,this._length=r+1,r+1)},i.prototype.pop=function(){var t=this._length;if(0!==t){var e=this._front+t-1&this._capacity-1,r=this[e];return this[e]=void 0,this._length=t-1,r}},i.prototype.shift=function(){var t=this._length;if(0!==t){var e=this._front,r=this[e];return this[e]=void 0,this._front=e+1&this._capacity-1,this._length=t-1,r}},i.prototype.unshift=function(t){var e=this._length,r=arguments.length;if(r>1){if(e+r>(o=this._capacity)){for(var n=r-1;n>=0;n--){this._checkCapacity(e+1);var o=this._capacity;this[s=(this._front-1&o-1^o)-o]=arguments[n],e++,this._length=e,this._front=s}return e}var i=this._front;for(n=r-1;n>=0;n--){var s;this[s=(i-1&o-1^o)-o]=arguments[n],i=s}return this._front=i,this._length=e+r,e+r}if(0===r)return e;this._checkCapacity(e+1);o=this._capacity;return this[n=(this._front-1&o-1^o)-o]=t,this._length=e+1,this._front=n,e+1},i.prototype.peekBack=function(){var t=this._length;if(0!==t)return this[this._front+t-1&this._capacity-1]},i.prototype.peekFront=function(){if(0!==this._length)return this[this._front]},i.prototype.get=function(t){var e=t;if(e===(0|e)){var r=this._length;if(e<0&&(e+=r),!(e<0||e>=r))return this[this._front+e&this._capacity-1]}},i.prototype.isEmpty=function(){return 0===this._length},i.prototype.clear=function(){for(var t=this._length,e=this._front,r=this._capacity,n=0;n<t;++n)this[e+n&r-1]=void 0;this._length=0,this._front=0},i.prototype.toString=function(){return this.toArray().toString()},i.prototype.valueOf=i.prototype.toString,i.prototype.removeFront=i.prototype.shift,i.prototype.removeBack=i.prototype.pop,i.prototype.insertFront=i.prototype.unshift,i.prototype.insertBack=i.prototype.push,i.prototype.enqueue=i.prototype.push,i.prototype.dequeue=i.prototype.shift,i.prototype.toJSON=i.prototype.toArray,Object.defineProperty(i.prototype,"length",{get:function(){return this._length},set:function(){throw new RangeError("")}}),i.prototype._checkCapacity=function(t){this._capacity<t&&this._resizeTo(a(1.5*this._capacity+16))},i.prototype._resizeTo=function(t){var e=this._capacity;this._capacity=t;var r=this._front,n=this._length;r+n>e&&function(t,e,r,n,o){for(var i=0;i<o;++i)r[i+n]=t[i+e],t[i+e]=void 0}(this,0,this,e,r+n&e-1)};var s=Array.isArray;function a(t){if("number"!=typeof t){if(!s(t))return 16;t=t.length}return e=Math.min(Math.max(16,t),1073741824),e>>>=0,e-=1,e|=e>>1,e|=e>>2,e|=e>>4,e|=e>>8,1+(e|=e>>16);var e}var c=i,l=function(){for(var t={},e=0;e<arguments.length;e++){var r=arguments[e];for(var n in r)u.call(r,n)&&(t[n]=r[n])}return t},u=Object.prototype.hasOwnProperty;function h(t){return(h="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function p(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function f(t){return function(t){if(Array.isArray(t))return d(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||function(t,e){if(!t)return;if("string"==typeof t)return d(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);"Object"===r&&t.constructor&&(r=t.constructor.name);if("Map"===r||"Set"===r)return Array.from(t);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return d(t,e)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function d(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}var y=o,_=c,v=l,g="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz",m="plugin disabled",w="invalid context",b="not handled",k="unsupported command",E=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.bufferSize=e.bufferSize||256,this.handlers=e.handlers,this.helpfulStacks=!!e.helpfulStacks,this.hostHandlers=e.hostHandlers,this.local=e.local,this.noisy="boolean"!=typeof e.noisy||e.noisy,this.Promise=e.Promise||window.Promise,this.remote=e.remote,this.secret=e.secret,this.Sentry=e.Sentry,this.strict=!!e.strict,this.targetOrigin=e.targetOrigin,this._seed=t.randomId(16),this._ctr=0,this._pendingRequests={},this._messageQueues=new Map;try{this._messageQueues.set(this.remote,new _(this.bufferSize))}catch(t){this._targetsFallback={remote:this.remote}}this.listen()}var e,r,n;return e=t,n=[{key:"randomId",value:function(t){var e=t||16,r=[];if(window.crypto&&window.crypto.getRandomValues)r=window.crypto.getRandomValues(new Uint32Array(e));else if("object"===h(window.msCrypto)&&"function"==typeof window.msCrypto.getRandomValues)r=window.msCrypto.getRandomValues(new Uint32Array(e));else for(;r.length<e;)r.push(Math.floor(Math.random()*g.length));for(var n=[],o=0;o<e;o+=1)n.push(g[r[o]%g.length]);return n.join("")}},{key:"errorWithStack",value:function(t,e,r){var n=new t(e);return r&&(n.stack=r),n}}],(r=[{key:"_handleMessage",value:function(t,e){var r=this,n=t.data;switch(t.type){case"request":this._handleRequest(n.id,n.command,n.args,e);break;case"response":this._handleResponse(n.to,n.success,n.response);break;case"bulk":n.forEach((function(t){return r._handleMessage(t,e)}))}}},{key:"listen",value:function(){var t=this;this.stop(),this.listener=function(e){var r=e.source;null!=e.data&&(r!==t.remote&&e.data.secret!==t.secret||t._handleMessage(e.data,r))},this.local.addEventListener("message",this.listener)}},{key:"stop",value:function(){this.local.removeEventListener("message",this.listener)}},{key:"_handleRequest",value:function(e,r,n,o){var i=this,s=v(this.hostHandlers,{PluginDisabled:t.PluginDisabled,InvalidContext:t.InvalidContext,NotHandled:t.NotHandled,command:r,args:n,source:o,request:function(){for(var t=arguments.length,e=new Array(t),r=0;r<t;r++)e[r]=arguments[r];return i.request.apply(i,f(e.concat([o])))},secret:this.secret});this.Promise.try((function(){if(!Object.prototype.hasOwnProperty.call(i.handlers,r))throw new t.UnsupportedCommand("unsupported command: ".concat(r));return i.handlers[r].apply(i,[s].concat(n))})).then((function(t){i.respond(e,!0,t,o)})).catch((function(t){i.Sentry&&t.code!==b?i.Sentry.withScope((function(e){if(e.setTag("command",r),n&&n[0]&&n[0].context){var o=n[0].context;e.setTag("idBoard",o.board),"object"===h(o.permissions)&&Object.keys(o.permissions).forEach((function(t){e.setExtra("".concat(t,"_permission"),o.permissions[t])}))}i.Sentry.captureException(t)})):i.noisy&&t.code!==b&&"function"==typeof console.warn&&(console.warn("Power-Up unhandled error responding to request for",r),console.warn(t)),i.respond(e,!1,{code:t.code,message:t.message},o)}))}},{key:"_handleResponse",value:function(e,r,n){if(!Object.prototype.hasOwnProperty.call(this._pendingRequests,e))return null;var o=this._pendingRequests[e];if(delete this._pendingRequests[e],r)return o.resolve(n);var i="".concat(n.message||""," (Command: ").concat(o.command,")");switch(n.code){case m:return o.reject(t.errorWithStack(t.PluginDisabled,i,o.stack));case w:return o.reject(t.errorWithStack(t.InvalidContext,i,o.stack));case b:return o.reject(t.errorWithStack(t.NotHandled,i,o.stack));case k:return o.reject(t.errorWithStack(t.UnsupportedCommand,i,o.stack));default:return o.reject(t.errorWithStack(Error,i,o.stack))}}},{key:"raw",value:function(e,r,n){var o=this;if("bulk"===e){var i={data:r,secret:this.secret,type:e};n&&n!==this.remote?n.postMessage(i,this.strict?this.targetOrigin:"*"):this.remote.postMessage(i,this.targetOrigin)}else{var s=n||this.remote;if(this._targetsFallback)if(n===this.remote)s="remote";else{s=void 0;for(var a=Object.keys(this._targetsFallback),c=0;c<a.length;c++){var l=a[c];if(this._targetsFallback[l]===n){s=l;break}}s||(s=t.randomId(8),this._targetsFallback[s]=n)}this._messageQueues.has(s)||this._messageQueues.set(s,new _(this.bufferSize));var u=this._messageQueues.get(s);u.isEmpty()&&setTimeout((function(){return o.emptyQueue(s)}),0),u.push({type:e,data:r})}}},{key:"emptyQueue",value:function(t){var e=this._messageQueues.get(t);if(!e.isEmpty()){var r=e.toArray();e.clear();var n="string"==typeof t?this._targetsFallback[t]:t;t!==this.remote&&"remote"!==t&&(this._messageQueues.delete(t),this._targetsFallback&&delete this._targetsFallback[t]),this.raw("bulk",r,n)}}},{key:"request",value:function(t){var e=this;this._ctr+=1;for(var r=this._seed+this._ctr,n=arguments.length,o=new Array(n>1?n-1:0),i=1;i<n;i++)o[i-1]=arguments[i];var s,a=o[o.length-1];a&&"function"==typeof a.postMessage&&(s=o.pop());var c={args:o,command:t,id:r};return this.helpfulStacks&&(c.stack=(new Error).stack),this.raw("request",{args:o,command:t,id:r},s),new this.Promise((function(t,n){c.resolve=t,c.reject=n,e._pendingRequests[r]=c}))}},{key:"respond",value:function(t,e,r,n){this.raw("response",{response:r,success:e,to:t},n)}}])&&p(e.prototype,r),n&&p(e,n),Object.defineProperty(e,"prototype",{writable:!1}),t}();E.PluginDisabled=y("PostMessageIO:PluginDisabled"),E.PluginDisabled.prototype.code=m,E.InvalidContext=y("PostMessageIO:InvalidContext"),E.InvalidContext.prototype.code=w,E.NotHandled=y("PostMessageIO:NotHandled"),E.NotHandled.prototype.code=b,E.UnsupportedCommand=y("PostMessageIO:UnsupportedCommand"),E.UnsupportedCommand.prototype.code=k;var C,j,A,S=E,F={exports:{}},x={exports:{}};function O(){if(C)return x.exports;C=1;var t=function(){return void 0===this}();if(t)x.exports={freeze:Object.freeze,defineProperty:Object.defineProperty,getDescriptor:Object.getOwnPropertyDescriptor,keys:Object.keys,names:Object.getOwnPropertyNames,getPrototypeOf:Object.getPrototypeOf,isArray:Array.isArray,isES5:t,propertyIsWritable:function(t,e){var r=Object.getOwnPropertyDescriptor(t,e);return!(r&&!r.writable&&!r.set)}};else{var e={}.hasOwnProperty,r={}.toString,n={}.constructor.prototype,o=function(t){var r=[];for(var n in t)e.call(t,n)&&r.push(n);return r};x.exports={isArray:function(t){try{return"[object Array]"===r.call(t)}catch(t){return!1}},keys:o,names:o,defineProperty:function(t,e,r){return t[e]=r.value,t},getDescriptor:function(t,e){return{value:t[e]}},freeze:function(t){return t},getPrototypeOf:function(t){try{return Object(t).constructor.prototype}catch(t){return n}},isES5:t,propertyIsWritable:function(){return!0}}}return x.exports}function T(){if(A)return j;A=1;var t,e=O(),r="undefined"==typeof navigator,n=function(){try{var t={};return e.defineProperty(t,"f",{get:function(){return 3}}),3===t.f}catch(t){return!1}}(),o={e:{}};function i(){try{var e=t;return t=null,e.apply(this,arguments)}catch(t){return o.e=t,o}}function s(t){return null==t||!0===t||!1===t||"string"==typeof t||"number"==typeof t}function a(t,r,n){if(s(t))return t;var o={value:n,configurable:!0,enumerable:!1,writable:!0};return e.defineProperty(t,r,o),t}var c=function(){var t=[Array.prototype,Object.prototype,Function.prototype],r=function(e){for(var r=0;r<t.length;++r)if(t[r]===e)return!0;return!1};if(e.isES5){var n=Object.getOwnPropertyNames;return function(t){for(var o=[],i=Object.create(null);null!=t&&!r(t);){var s;try{s=n(t)}catch(t){return o}for(var a=0;a<s.length;++a){var c=s[a];if(!i[c]){i[c]=!0;var l=Object.getOwnPropertyDescriptor(t,c);null!=l&&null==l.get&&null==l.set&&o.push(c)}}t=e.getPrototypeOf(t)}return o}}var o={}.hasOwnProperty;return function(e){if(r(e))return[];var n=[];t:for(var i in e)if(o.call(e,i))n.push(i);else{for(var s=0;s<t.length;++s)if(o.call(t[s],i))continue t;n.push(i)}return n}}(),l=/this\s*\.\s*\S+\s*=/;var u=/^[a-z$_][a-z$_0-9]*$/i;function h(t){try{return t+""}catch(t){return"[no string representation]"}}function p(t){return t instanceof Error&&e.propertyIsWritable(t,"stack")}var f="stack"in new Error?function(t){return p(t)?t:new Error(h(t))}:function(t){if(p(t))return t;try{throw new Error(h(t))}catch(t){return t}};function d(t){return{}.toString.call(t)}var y,_={isClass:function(t){try{if("function"==typeof t){var r=e.names(t.prototype),n=e.isES5&&r.length>1,o=r.length>0&&!(1===r.length&&"constructor"===r[0]),i=l.test(t+"")&&e.names(t).length>0;if(n||o||i)return!0}return!1}catch(t){return!1}},isIdentifier:function(t){return u.test(t)},inheritedDataKeys:c,getDataPropertyOrDefault:function(t,r,n){if(!e.isES5)return{}.hasOwnProperty.call(t,r)?t[r]:void 0;var o=Object.getOwnPropertyDescriptor(t,r);return null!=o?null==o.get&&null==o.set?o.value:n:void 0},thrower:function(t){throw t},isArray:e.isArray,haveGetters:n,notEnumerableProp:a,isPrimitive:s,isObject:function(t){return!s(t)},canEvaluate:r,errorObj:o,tryCatch:function(e){return t=e,i},inherits:function(t,e){var r={}.hasOwnProperty;function n(){for(var n in this.constructor=t,this.constructor$=e,e.prototype)r.call(e.prototype,n)&&"$"!==n.charAt(n.length-1)&&(this[n+"$"]=e.prototype[n])}return n.prototype=e.prototype,t.prototype=new n,t.prototype},withAppended:function(t,e){var r,n=t.length,o=new Array(n+1);for(r=0;r<n;++r)o[r]=t[r];return o[r]=e,o},maybeWrapAsError:function(t){return s(t)?new Error(h(t)):t},toFastProperties:function(t){return t},filledRange:function(t,e,r){for(var n=new Array(t),o=0;o<t;++o)n[o]=e+o+r;return n},toString:h,canAttachTrace:p,ensureErrorObject:f,originatesFromRejection:function(t){return null!=t&&(t instanceof Error.__BluebirdErrorTypes__.OperationalError||!0===t.isOperational)},markAsOriginatingFromRejection:function(t){try{a(t,"isOperational",!0)}catch(t){}},classString:d,copyDescriptors:function(t,r,n){for(var o=e.names(t),i=0;i<o.length;++i){var s=o[i];if(n(s))try{e.defineProperty(r,s,e.getDescriptor(t,s))}catch(t){}}},hasDevTools:"undefined"!=typeof chrome&&chrome&&"function"==typeof chrome.loadTimes,isNode:"undefined"!=typeof process&&"[object process]"===d(process).toLowerCase()};_.isRecentNode=_.isNode&&(0===(y=process.versions.node.split(".").map(Number))[0]&&y[1]>10||y[0]>0),_.isNode&&_.toFastProperties(process);try{throw new Error}catch(t){_.lastLineError=t}return j=_}var P,R,D,I,B,N,U,M,z,q,L,H,$,W,V,K,Q,J,G,X,Y,Z,tt,et,rt,nt,ot,it,st,at,ct,lt,ut,ht,pt,ft,dt,yt,_t,vt,gt,mt,wt,bt,kt,Et,Ct,jt,At,St,Ft,xt,Ot,Tt,Pt,Rt,Dt,It,Bt,Nt,Ut,Mt,zt,qt,Lt,Ht,$t,Wt,Vt,Kt={exports:{}};function Qt(){if(B)return Kt.exports;var t;B=1;try{throw new Error}catch(e){t=e}var r=function(){if(R)return P;var t;R=1;var r=T();if(r.isNode&&"undefined"==typeof MutationObserver){var n=e.setImmediate,o=process.nextTick;t=r.isRecentNode?function(t){n.call(e,t)}:function(t){o.call(process,t)}}else"undefined"==typeof MutationObserver||"undefined"!=typeof window&&window.navigator&&window.navigator.standalone?t="undefined"!=typeof setImmediate?function(t){setImmediate(t)}:"undefined"!=typeof setTimeout?function(t){setTimeout(t,0)}:function(){throw new Error("No async scheduler available\n\n    See http://goo.gl/m3OTXk\n")}:(t=function(t){var e=document.createElement("div");return new MutationObserver(t).observe(e,{attributes:!0}),function(){e.classList.toggle("foo")}}).isStatic=!0;return P=t}(),n=function(){if(I)return D;function t(t){this._capacity=t,this._length=0,this._front=0}return I=1,t.prototype._willBeOverCapacity=function(t){return this._capacity<t},t.prototype._pushOne=function(t){var e=this.length();this._checkCapacity(e+1),this[this._front+e&this._capacity-1]=t,this._length=e+1},t.prototype._unshiftOne=function(t){var e=this._capacity;this._checkCapacity(this.length()+1);var r=(this._front-1&e-1^e)-e;this[r]=t,this._front=r,this._length=this.length()+1},t.prototype.unshift=function(t,e,r){this._unshiftOne(r),this._unshiftOne(e),this._unshiftOne(t)},t.prototype.push=function(t,e,r){var n=this.length()+3;if(this._willBeOverCapacity(n))return this._pushOne(t),this._pushOne(e),void this._pushOne(r);var o=this._front+n-3;this._checkCapacity(n);var i=this._capacity-1;this[o+0&i]=t,this[o+1&i]=e,this[o+2&i]=r,this._length=n},t.prototype.shift=function(){var t=this._front,e=this[t];return this[t]=void 0,this._front=t+1&this._capacity-1,this._length--,e},t.prototype.length=function(){return this._length},t.prototype._checkCapacity=function(t){this._capacity<t&&this._resizeTo(this._capacity<<1)},t.prototype._resizeTo=function(t){var e=this._capacity;this._capacity=t,function(t,e,r,n,o){for(var i=0;i<o;++i)r[i+n]=t[i+e],t[i+e]=void 0}(this,0,this,e,this._front+this._length&e-1)},D=t}(),o=T();function i(){this._isTickUsed=!1,this._lateQueue=new n(16),this._normalQueue=new n(16),this._trampolineEnabled=!0;var t=this;this.drainQueues=function(){t._drainQueues()},this._schedule=r.isStatic?r(this.drainQueues):r}function s(t,e,r){this._lateQueue.push(t,e,r),this._queueTick()}function a(t,e,r){this._normalQueue.push(t,e,r),this._queueTick()}function c(t){this._normalQueue._pushOne(t),this._queueTick()}return i.prototype.disableTrampolineIfNecessary=function(){o.hasDevTools&&(this._trampolineEnabled=!1)},i.prototype.enableTrampoline=function(){this._trampolineEnabled||(this._trampolineEnabled=!0,this._schedule=function(t){setTimeout(t,0)})},i.prototype.haveItemsQueued=function(){return this._normalQueue.length()>0},i.prototype.throwLater=function(t,e){if(1===arguments.length&&(e=t,t=function(){throw e}),"undefined"!=typeof setTimeout)setTimeout((function(){t(e)}),0);else try{this._schedule((function(){t(e)}))}catch(t){throw new Error("No async scheduler available\n\n    See http://goo.gl/m3OTXk\n")}},o.hasDevTools?(r.isStatic&&(r=function(t){setTimeout(t,0)}),i.prototype.invokeLater=function(t,e,r){this._trampolineEnabled?s.call(this,t,e,r):this._schedule((function(){setTimeout((function(){t.call(e,r)}),100)}))},i.prototype.invoke=function(t,e,r){this._trampolineEnabled?a.call(this,t,e,r):this._schedule((function(){t.call(e,r)}))},i.prototype.settlePromises=function(t){this._trampolineEnabled?c.call(this,t):this._schedule((function(){t._settlePromises()}))}):(i.prototype.invokeLater=s,i.prototype.invoke=a,i.prototype.settlePromises=c),i.prototype.invokeFirst=function(t,e,r){this._normalQueue.unshift(t,e,r),this._queueTick()},i.prototype._drainQueue=function(t){for(;t.length()>0;){var e=t.shift();if("function"==typeof e){var r=t.shift(),n=t.shift();e.call(r,n)}else e._settlePromises()}},i.prototype._drainQueues=function(){this._drainQueue(this._normalQueue),this._reset(),this._drainQueue(this._lateQueue)},i.prototype._queueTick=function(){this._isTickUsed||(this._isTickUsed=!0,this._schedule(this.drainQueues))},i.prototype._reset=function(){this._isTickUsed=!1},Kt.exports=new i,Kt.exports.firstLineError=t,Kt.exports}function Jt(){if(U)return N;U=1;var t,e,r=O(),n=r.freeze,o=T(),i=o.inherits,s=o.notEnumerableProp;function a(t,e){function r(n){if(!(this instanceof r))return new r(n);s(this,"message","string"==typeof n?n:e),s(this,"name",t),Error.captureStackTrace?Error.captureStackTrace(this,this.constructor):Error.call(this)}return i(r,Error),r}var c=a("Warning","warning"),l=a("CancellationError","cancellation error"),u=a("TimeoutError","timeout error"),h=a("AggregateError","aggregate error");try{t=TypeError,e=RangeError}catch(r){t=a("TypeError","type error"),e=a("RangeError","range error")}for(var p="join pop push shift unshift slice filter forEach some every map indexOf lastIndexOf reduce reduceRight sort reverse".split(" "),f=0;f<p.length;++f)"function"==typeof Array.prototype[p[f]]&&(h.prototype[p[f]]=Array.prototype[p[f]]);r.defineProperty(h.prototype,"length",{value:0,configurable:!1,writable:!0,enumerable:!0}),h.prototype.isOperational=!0;var d=0;function y(t){if(!(this instanceof y))return new y(t);s(this,"name","OperationalError"),s(this,"message",t),this.cause=t,this.isOperational=!0,t instanceof Error?(s(this,"message",t.message),s(this,"stack",t.stack)):Error.captureStackTrace&&Error.captureStackTrace(this,this.constructor)}h.prototype.toString=function(){var t=Array(4*d+1).join(" "),e="\n"+t+"AggregateError of:\n";d++,t=Array(4*d+1).join(" ");for(var r=0;r<this.length;++r){for(var n=this[r]===this?"[Circular AggregateError]":this[r]+"",o=n.split("\n"),i=0;i<o.length;++i)o[i]=t+o[i];e+=(n=o.join("\n"))+"\n"}return d--,e},i(y,Error);var _=Error.__BluebirdErrorTypes__;return _||(_=n({CancellationError:l,TimeoutError:u,OperationalError:y,RejectionError:y,AggregateError:h}),s(Error,"__BluebirdErrorTypes__",_)),N={Error:Error,TypeError:t,RangeError:e,CancellationError:_.CancellationError,OperationalError:_.OperationalError,TimeoutError:_.TimeoutError,AggregateError:_.AggregateError,Warning:c}}function Gt(){return z?M:(z=1,M=function(t,e){var r=T(),n=r.errorObj,o=r.isObject;function i(t){return t.then}var s={}.hasOwnProperty;return function(a,c){if(o(a)){if(a instanceof t)return a;if(function(t){return s.call(t,"_promise0")}(a)){var l=new t(e);return a._then(l._fulfillUnchecked,l._rejectUncheckedCheckError,l._progressUnchecked,l,null),l}var u=r.tryCatch(i)(a);if(u===n){c&&c._pushContext();l=t.reject(u.e);return c&&c._popContext(),l}if("function"==typeof u)return function(o,i,s){var a=new t(e),c=a;s&&s._pushContext();a._captureStackTrace(),s&&s._popContext();var l=!0,u=r.tryCatch(i).call(o,h,p,f);l=!1,a&&u===n&&(a._rejectCallback(u.e,!0,!0),a=null);function h(t){a&&(a._resolveCallback(t),a=null)}function p(t){a&&(a._rejectCallback(t,l,!0),a=null)}function f(t){a&&"function"==typeof a._progress&&a._progress(t)}return c}(a,u,c)}return a}})}function Xt(){return $?H:($=1,H=function(){var t,e=Qt(),r=T(),n=/[\\\/]bluebird[\\\/]js[\\\/](main|debug|zalgo|instrumented)/,o=null,i=null,s=!1;function a(t){this._parent=t;var e=this._length=1+(void 0===t?0:t._length);d(this,a),e>32&&this.uncycle()}function c(t){for(var e=[],r=0;r<t.length;++r){var n=t[r],i=o.test(n)||"    (No stack trace)"===n,a=i&&u(n);i&&!a&&(s&&" "!==n.charAt(0)&&(n="    "+n),e.push(n))}return e}function l(t){var e;if("function"==typeof t)e="[function "+(t.name||"anonymous")+"]";else{e=t.toString();if(/\[object [a-zA-Z0-9$_]+\]/.test(e))try{e=JSON.stringify(t)}catch(t){}0===e.length&&(e="(empty array)")}return"(<"+function(t){var e=41;if(t.length<e)return t;return t.substr(0,e-3)+"..."}(e)+">, no stack trace)"}r.inherits(a,Error),a.prototype.uncycle=function(){var t=this._length;if(!(t<2)){for(var e=[],r={},n=0,o=this;void 0!==o;++n)e.push(o),o=o._parent;for(n=(t=this._length=n)-1;n>=0;--n){var i=e[n].stack;void 0===r[i]&&(r[i]=n)}for(n=0;n<t;++n){var s=r[e[n].stack];if(void 0!==s&&s!==n){s>0&&(e[s-1]._parent=void 0,e[s-1]._length=1),e[n]._parent=void 0,e[n]._length=1;var a=n>0?e[n-1]:this;s<t-1?(a._parent=e[s+1],a._parent.uncycle(),a._length=a._parent._length+1):(a._parent=void 0,a._length=1);for(var c=a._length+1,l=n-2;l>=0;--l)e[l]._length=c,c++;return}}}},a.prototype.parent=function(){return this._parent},a.prototype.hasParent=function(){return void 0!==this._parent},a.prototype.attachExtraTrace=function(t){if(!t.__stackCleaned__){this.uncycle();for(var e=a.parseStackAndMessage(t),n=e.message,o=[e.stack],i=this;void 0!==i;)o.push(c(i.stack.split("\n"))),i=i._parent;!function(t){for(var e=t[0],r=1;r<t.length;++r){for(var n=t[r],o=e.length-1,i=e[o],s=-1,a=n.length-1;a>=0;--a)if(n[a]===i){s=a;break}for(a=s;a>=0;--a){var c=n[a];if(e[o]!==c)break;e.pop(),o--}e=n}}(o),function(t){for(var e=0;e<t.length;++e)(0===t[e].length||e+1<t.length&&t[e][0]===t[e+1][0])&&(t.splice(e,1),e--)}(o),r.notEnumerableProp(t,"stack",function(t,e){for(var r=0;r<e.length-1;++r)e[r].push("From previous event:"),e[r]=e[r].join("\n");r<e.length&&(e[r]=e[r].join("\n"));return t+"\n"+e.join("\n")}(n,o)),r.notEnumerableProp(t,"__stackCleaned__",!0)}},a.parseStackAndMessage=function(t){var e=t.stack;return{message:t.toString(),stack:c(e="string"==typeof e&&e.length>0?function(t){for(var e=t.stack.replace(/\s+$/g,"").split("\n"),r=0;r<e.length;++r){var n=e[r];if("    (No stack trace)"===n||o.test(n))break}return r>0&&(e=e.slice(r)),e}(t):["    (No stack trace)"])}},a.formatAndLogError=function(e,r){if("undefined"!=typeof console){var n;if("object"==typeof e||"function"==typeof e){var o=e.stack;n=r+i(o,e)}else n=r+String(e);"function"==typeof t?t(n):"function"!=typeof console.log&&"object"!=typeof console.log||console.log(n)}},a.unhandledRejection=function(t){a.formatAndLogError(t,"^--- With additional stack trace: ")},a.isSupported=function(){return"function"==typeof d},a.fireRejectionEvent=function(t,r,n,o){var i=!1;try{"function"==typeof r&&(i=!0,"rejectionHandled"===t?r(o):r(n,o))}catch(t){e.throwLater(t)}var s=!1;try{s=y(t,n,o)}catch(t){s=!0,e.throwLater(t)}var c=!1;if(f)try{c=f(t.toLowerCase(),{reason:n,promise:o})}catch(t){c=!0,e.throwLater(t)}s||i||c||"unhandledRejection"!==t||a.formatAndLogError(n,"Unhandled rejection ")};var u=function(){return!1},h=/[\/<\(]([^:\/]+):(\d+):(?:\d+)\)?\s*$/;function p(t){var e=t.match(h);if(e)return{fileName:e[1],line:parseInt(e[2],10)}}a.setBounds=function(t,e){if(a.isSupported()){for(var r,o,i=t.stack.split("\n"),s=e.stack.split("\n"),c=-1,l=-1,h=0;h<i.length;++h){if(f=p(i[h])){r=f.fileName,c=f.line;break}}for(h=0;h<s.length;++h){var f;if(f=p(s[h])){o=f.fileName,l=f.line;break}}c<0||l<0||!r||!o||r!==o||c>=l||(u=function(t){if(n.test(t))return!0;var e=p(t);return!!(e&&e.fileName===r&&c<=e.line&&e.line<=l)})}};var f,d=function(){var t=/^\s*at\s*/,e=function(t,e){return"string"==typeof t?t:void 0!==e.name&&void 0!==e.message?e.toString():l(e)};if("number"==typeof Error.stackTraceLimit&&"function"==typeof Error.captureStackTrace){Error.stackTraceLimit=Error.stackTraceLimit+6,o=t,i=e;var r=Error.captureStackTrace;return u=function(t){return n.test(t)},function(t,e){Error.stackTraceLimit=Error.stackTraceLimit+6,r(t,e),Error.stackTraceLimit=Error.stackTraceLimit-6}}var a,c=new Error;if("string"==typeof c.stack&&c.stack.split("\n")[0].indexOf("stackDetection@")>=0)return o=/@/,i=e,s=!0,function(t){t.stack=(new Error).stack};try{throw new Error}catch(t){a="stack"in t}return!("stack"in c)&&a&&"number"==typeof Error.stackTraceLimit?(o=t,i=e,function(t){Error.stackTraceLimit=Error.stackTraceLimit+6;try{throw new Error}catch(e){t.stack=e.stack}Error.stackTraceLimit=Error.stackTraceLimit-6}):(i=function(t,e){return"string"==typeof t?t:"object"!=typeof e&&"function"!=typeof e||void 0===e.name||void 0===e.message?l(e):e.toString()},null)}(),y=function(){if(r.isNode)return function(t,e,r){return"rejectionHandled"===t?process.emit(t,r):process.emit(t,e,r)};var t=!1,e=!0;try{var n=new self.CustomEvent("test");t=n instanceof CustomEvent}catch(t){}if(!t)try{var o=document.createEvent("CustomEvent");o.initCustomEvent("testingtheevent",!1,!0,{}),self.dispatchEvent(o)}catch(t){e=!1}e&&(f=function(e,r){var n;return t?n=new self.CustomEvent(e,{detail:r,bubbles:!1,cancelable:!0}):self.dispatchEvent&&(n=document.createEvent("CustomEvent")).initCustomEvent(e,!1,!0,r),!!n&&!self.dispatchEvent(n)});var i={};return i.unhandledRejection="onunhandledRejection".toLowerCase(),i.rejectionHandled="onrejectionHandled".toLowerCase(),function(t,e,r){var n=i[t],o=self[n];return!!o&&("rejectionHandled"===t?o.call(self,r):o.call(self,e,r),!0)}}();return"undefined"!=typeof console&&void 0!==console.warn&&(t=function(t){console.warn(t)},r.isNode&&process.stderr.isTTY?t=function(t){process.stderr.write("[31m"+t+"[39m\n")}:r.isNode||"string"!=typeof(new Error).stack||(t=function(t){console.warn("%c"+t,"color: red")})),a})}function Yt(){if(Y)return X;Y=1;var t=T(),e=t.maybeWrapAsError,r=Jt(),n=r.TimeoutError,o=r.OperationalError,i=t.haveGetters,s=O();var a,c=/^(?:name|message|stack|cause)$/;function l(e){var r;if(function(t){return t instanceof Error&&s.getPrototypeOf(t)===Error.prototype}(e)){(r=new o(e)).name=e.name,r.message=e.message,r.stack=e.stack;for(var n=s.keys(e),i=0;i<n.length;++i){var a=n[i];c.test(a)||(r[a]=e[a])}return r}return t.markAsOriginatingFromRejection(e),e}function u(t){return function(r,n){if(null!==t){if(r){var o=l(e(r));t._attachExtraTrace(o),t._reject(o)}else if(arguments.length>2){for(var i=arguments.length,s=new Array(i-1),a=1;a<i;++a)s[a-1]=arguments[a];t._fulfill(s)}else t._fulfill(n);t=null}}}if(a=i?function(t){this.promise=t}:function(t){this.promise=t,this.asCallback=u(t),this.callback=this.asCallback},i){var h={get:function(){return u(this.promise)}};s.defineProperty(a.prototype,"asCallback",h),s.defineProperty(a.prototype,"callback",h)}return a._nodebackForPromise=u,a.prototype.toString=function(){return"[object PromiseResolver]"},a.prototype.resolve=a.prototype.fulfill=function(t){if(!(this instanceof a))throw new TypeError("Illegal invocation, resolver resolve/reject must be called within a resolver context. Consider using the promise constructor instead.\n\n    See http://goo.gl/sdkXL9\n");this.promise._resolveCallback(t)},a.prototype.reject=function(t){if(!(this instanceof a))throw new TypeError("Illegal invocation, resolver resolve/reject must be called within a resolver context. Consider using the promise constructor instead.\n\n    See http://goo.gl/sdkXL9\n");this.promise._rejectCallback(t)},a.prototype.progress=function(t){if(!(this instanceof a))throw new TypeError("Illegal invocation, resolver resolve/reject must be called within a resolver context. Consider using the promise constructor instead.\n\n    See http://goo.gl/sdkXL9\n");this.promise._progress(t)},a.prototype.cancel=function(t){this.promise.cancel(t)},a.prototype.timeout=function(){this.reject(new n("timeout"))},a.prototype.isResolved=function(){return this.promise.isResolved()},a.prototype.toJSON=function(){return this.promise.toJSON()},X=a}function Zt(){return ut?lt:(ut=1,lt=function(t){function e(t){void 0!==t?(t=t._target(),this._bitField=t._bitField,this._settledValue=t._settledValue):(this._bitField=0,this._settledValue=void 0)}e.prototype.value=function(){if(!this.isFulfilled())throw new TypeError("cannot get fulfillment value of a non-fulfilled promise\n\n    See http://goo.gl/hc1DLj\n");return this._settledValue},e.prototype.error=e.prototype.reason=function(){if(!this.isRejected())throw new TypeError("cannot get rejection reason of a non-rejected promise\n\n    See http://goo.gl/hPuiwB\n");return this._settledValue},e.prototype.isFulfilled=t.prototype._isFulfilled=function(){return(268435456&this._bitField)>0},e.prototype.isRejected=t.prototype._isRejected=function(){return(134217728&this._bitField)>0},e.prototype.isPending=t.prototype._isPending=function(){return 0==(402653184&this._bitField)},e.prototype.isResolved=t.prototype._isResolved=function(){return(402653184&this._bitField)>0},t.prototype.isPending=function(){return this._target()._isPending()},t.prototype.isRejected=function(){return this._target()._isRejected()},t.prototype.isFulfilled=function(){return this._target()._isFulfilled()},t.prototype.isResolved=function(){return this._target()._isResolved()},t.prototype._value=function(){return this._settledValue},t.prototype._reason=function(){return this._unsetRejectionIsUnhandled(),this._settledValue},t.prototype.value=function(){var t=this._target();if(!t.isFulfilled())throw new TypeError("cannot get fulfillment value of a non-fulfilled promise\n\n    See http://goo.gl/hc1DLj\n");return t._settledValue},t.prototype.reason=function(){var t=this._target();if(!t.isRejected())throw new TypeError("cannot get rejection reason of a non-rejected promise\n\n    See http://goo.gl/hPuiwB\n");return t._unsetRejectionIsUnhandled(),t._settledValue},t.PromiseInspection=e})}function te(){return gt?vt:(gt=1,vt=function(t,e,r,n){var o=Jt().TypeError,i=T().inherits,s=t.PromiseInspection;function a(e){for(var r=e.length,n=0;n<r;++n){var o=e[n];if(o.isRejected())return t.reject(o.error());e[n]=o._settledValue}return e}function c(t){setTimeout((function(){throw t}),0)}function l(e,n){var o=0,i=e.length,s=t.defer();return function a(){if(o>=i)return s.resolve();var l=function(t){var e=r(t);return e!==t&&"function"==typeof t._isDisposable&&"function"==typeof t._getDisposer&&t._isDisposable()&&e._setDisposable(t._getDisposer()),e}(e[o++]);if(l instanceof t&&l._isDisposable()){try{l=r(l._getDisposer().tryDispose(n),e.promise)}catch(t){return c(t)}if(l instanceof t)return l._then(a,c,null,null,null)}a()}(),s.promise}function u(t){var e=new s;return e._settledValue=t,e._bitField=268435456,l(this,e).thenReturn(t)}function h(t){var e=new s;return e._settledValue=t,e._bitField=134217728,l(this,e).thenThrow(t)}function p(t,e,r){this._data=t,this._promise=e,this._context=r}function f(t,e,r){this.constructor$(t,e,r)}function d(t){return p.isDisposer(t)?(this.resources[this.index]._setDisposable(t),t.promise()):t}p.prototype.data=function(){return this._data},p.prototype.promise=function(){return this._promise},p.prototype.resource=function(){return this.promise().isFulfilled()?this.promise().value():null},p.prototype.tryDispose=function(t){var e=this.resource(),r=this._context;void 0!==r&&r._pushContext();var n=null!==e?this.doDispose(e,t):null;return void 0!==r&&r._popContext(),this._promise._unsetDisposable(),this._data=null,n},p.isDisposer=function(t){return null!=t&&"function"==typeof t.resource&&"function"==typeof t.tryDispose},i(f,p),f.prototype.doDispose=function(t,e){return this.data().call(t,t,e)},t.using=function(){var n=arguments.length;if(n<2)return e("you must pass at least 2 arguments to Promise.using");var o,i=arguments[n-1];if("function"!=typeof i)return e("fn must be a function\n\n    See http://goo.gl/916lJJ\n");var s=!0;2===n&&Array.isArray(arguments[0])?(n=(o=arguments[0]).length,s=!1):(o=arguments,n--);for(var c=new Array(n),l=0;l<n;++l){var f=o[l];if(p.isDisposer(f)){var y=f;(f=f.promise())._setDisposable(y)}else{var _=r(f);_ instanceof t&&(f=_._then(d,null,null,{resources:c,index:l},void 0))}c[l]=f}var v=t.settle(c).then(a).then((function(t){var e;v._pushContext();try{e=s?i.apply(void 0,t):i.call(void 0,t)}finally{v._popContext()}return e}))._then(u,h,void 0,c,void 0);return c.promise=v,v},t.prototype._setDisposable=function(t){this._bitField=262144|this._bitField,this._disposer=t},t.prototype._isDisposable=function(){return(262144&this._bitField)>0},t.prototype._getDisposer=function(){return this._disposer},t.prototype._unsetDisposable=function(){this._bitField=-262145&this._bitField,this._disposer=void 0},t.prototype.disposer=function(t){if("function"==typeof t)return new f(t,this,n());throw new o}})}function ee(){return wt?mt:(wt=1,mt=function(t,e,r,n){var o=Jt().TypeError,i=T(),s=i.errorObj,a=i.tryCatch,c=[];function l(e,n,o,i){(this._promise=new t(r))._captureStackTrace(),this._stack=i,this._generatorFunction=e,this._receiver=n,this._generator=void 0,this._yieldHandlers="function"==typeof o?[o].concat(c):c}l.prototype.promise=function(){return this._promise},l.prototype._run=function(){this._generator=this._generatorFunction.call(this._receiver),this._receiver=this._generatorFunction=void 0,this._next(void 0)},l.prototype._continue=function(e){if(e===s)return this._promise._rejectCallback(e.e,!1,!0);var r=e.value;if(!0===e.done)this._promise._resolveCallback(r);else{var i=n(r,this._promise);if(!(i instanceof t)&&null===(i=function(e,r,o){for(var i=0;i<r.length;++i){o._pushContext();var c=a(r[i])(e);if(o._popContext(),c===s){o._pushContext();var l=t.reject(s.e);return o._popContext(),l}var u=n(c,o);if(u instanceof t)return u}return null}(i,this._yieldHandlers,this._promise)))return void this._throw(new o("A value %s was yielded that could not be treated as a promise\n\n    See http://goo.gl/4Y4pDk\n\n".replace("%s",r)+"From coroutine:\n"+this._stack.split("\n").slice(1,-7).join("\n")));i._then(this._next,this._throw,void 0,this,null)}},l.prototype._throw=function(t){this._promise._attachExtraTrace(t),this._promise._pushContext();var e=a(this._generator.throw).call(this._generator,t);this._promise._popContext(),this._continue(e)},l.prototype._next=function(t){this._promise._pushContext();var e=a(this._generator.next).call(this._generator,t);this._promise._popContext(),this._continue(e)},t.coroutine=function(t,e){if("function"!=typeof t)throw new o("generatorFunction must be a function\n\n    See http://goo.gl/6Vqhm0\n");var r=Object(e).yieldHandler,n=l,i=(new Error).stack;return function(){var e=t.apply(this,arguments),o=new n(void 0,void 0,r,i);return o._generator=e,o._next(void 0),o.promise()}},t.coroutine.addYieldHandler=function(t){if("function"!=typeof t)throw new o("fn must be a function\n\n    See http://goo.gl/916lJJ\n");c.push(t)},t.spawn=function(r){if("function"!=typeof r)return e("generatorFunction must be a function\n\n    See http://goo.gl/6Vqhm0\n");var n=new l(r,this),o=n.promise();return n._run(t.spawn),o}})}function re(){return Ft?St:(Ft=1,St=function(t,e,r,n){var o=T().isArray;function i(s,a){var c=r(s);if(c instanceof t)return function(t){return t.then((function(e){return i(e,t)}))}(c);if(!o(s))return n("expecting an array, a promise or a thenable\n\n    See http://goo.gl/s8MMhc\n");var l=new t(e);void 0!==a&&l._propagateFrom(a,5);for(var u=l._fulfill,h=l._reject,p=0,f=s.length;p<f;++p){var d=s[p];(void 0!==d||p in s)&&t.cast(d)._then(u,h,void 0,l,null)}return l}t.race=function(t){return i(t,void 0)},t.prototype.race=function(){return i(this,void 0)}})}function ne(){return Bt?It:(Bt=1,It=function(t,e){var r={},n=T(),o=Yt()._nodebackForPromise,i=n.withAppended,s=n.maybeWrapAsError,a=n.canEvaluate,c=Jt().TypeError,l={__isPromisified__:!0},u=new RegExp("^(?:"+["arity","length","name","arguments","caller","callee","prototype","__isPromisified__"].join("|")+")$"),h=function(t){return n.isIdentifier(t)&&"_"!==t.charAt(0)&&"constructor"!==t};function p(t){return!u.test(t)}function f(t){try{return!0===t.__isPromisified__}catch(t){return!1}}function d(t,e,r){var o=n.getDataPropertyOrDefault(t,e+r,l);return!!o&&f(o)}function y(t,e,r,o){for(var i=n.inheritedDataKeys(t),s=[],a=0;a<i.length;++a){var l=i[a],u=t[l],p=o===h||h(l);"function"!=typeof u||f(u)||d(t,l,e)||!o(l,u,t,p)||s.push(l,u)}return function(t,e,r){for(var n=0;n<t.length;n+=2){var o=t[n];if(r.test(o))for(var i=o.replace(r,""),s=0;s<t.length;s+=2)if(t[s]===i)throw new c("Cannot promisify an API that has normal methods with '%s'-suffix\n\n    See http://goo.gl/iWrZbw\n".replace("%s",e))}}(s,e,r),s}var _=a?function(a,c,l,u){var h=Math.max(0,function(t){return"number"==typeof t.length?Math.max(Math.min(t.length,1024),0):0}(u)-1),p=function(t){for(var e=[t],r=Math.max(0,t-1-3),n=t-1;n>=r;--n)e.push(n);for(n=t+1;n<=3;++n)e.push(n);return e}(h),f="string"==typeof a||c===r;function d(t){var e,r=(e=t,n.filledRange(e,"_arg","")).join(", "),o=t>0?", ":"";return(f?"ret = callback.call(this, {{args}}, nodeback); break;\n":void 0===c?"ret = callback({{args}}, nodeback); break;\n":"ret = callback.call(receiver, {{args}}, nodeback); break;\n").replace("{{args}}",r).replace(", ",o)}var y="string"==typeof a?"this != null ? this['"+a+"'] : fn":"fn";return new Function("Promise","fn","receiver","withAppended","maybeWrapAsError","nodebackForPromise","tryCatch","errorObj","notEnumerableProp","INTERNAL","'use strict';                            \n\t        var ret = function (Parameters) {                                    \n\t            'use strict';                                                    \n\t            var len = arguments.length;                                      \n\t            var promise = new Promise(INTERNAL);                             \n\t            promise._captureStackTrace();                                    \n\t            var nodeback = nodebackForPromise(promise);                      \n\t            var ret;                                                         \n\t            var callback = tryCatch([GetFunctionCode]);                      \n\t            switch(len) {                                                    \n\t                [CodeForSwitchCase]                                          \n\t            }                                                                \n\t            if (ret === errorObj) {                                          \n\t                promise._rejectCallback(maybeWrapAsError(ret.e), true, true);\n\t            }                                                                \n\t            return promise;                                                  \n\t        };                                                                   \n\t        notEnumerableProp(ret, '__isPromisified__', true);                   \n\t        return ret;                                                          \n\t        ".replace("Parameters",function(t){return n.filledRange(Math.max(t,3),"_arg","")}(h)).replace("[CodeForSwitchCase]",function(){for(var t="",e=0;e<p.length;++e)t+="case "+p[e]+":"+d(p[e]);return t+="                                                             \n\t        default:                                                             \n\t            var args = new Array(len + 1);                                   \n\t            var i = 0;                                                       \n\t            for (var i = 0; i < len; ++i) {                                  \n\t               args[i] = arguments[i];                                       \n\t            }                                                                \n\t            args[i] = nodeback;                                              \n\t            [CodeForCall]                                                    \n\t            break;                                                           \n\t        ".replace("[CodeForCall]",f?"ret = callback.apply(this, args);\n":"ret = callback.apply(receiver, args);\n")}()).replace("[GetFunctionCode]",y))(t,u,c,i,s,o,n.tryCatch,n.errorObj,n.notEnumerableProp,e)}:function(a,c,l,u){var h=function(){return this}(),p=a;function f(){var n=c;c===r&&(n=this);var l=new t(e);l._captureStackTrace();var u="string"==typeof p&&this!==h?this[p]:a,f=o(l);try{u.apply(n,i(arguments,f))}catch(t){l._rejectCallback(s(t),!0,!0)}return l}return"string"==typeof p&&(a=u),n.notEnumerableProp(f,"__isPromisified__",!0),f};function v(t,e,o,i){for(var s=new RegExp(e.replace(/([$])/,"\\$")+"$"),a=y(t,e,s,o),c=0,l=a.length;c<l;c+=2){var u=a[c],h=a[c+1],p=u+e;if(i===_)t[p]=_(u,r,u,h,e);else{var f=i(h,(function(){return _(u,r,u,h,e)}));n.notEnumerableProp(f,"__isPromisified__",!0),t[p]=f}}return n.toFastProperties(t),t}function g(t,e){return _(t,e,void 0,t)}t.promisify=function(t,e){if("function"!=typeof t)throw new c("fn must be a function\n\n    See http://goo.gl/916lJJ\n");if(f(t))return t;var o=g(t,arguments.length<2?r:e);return n.copyDescriptors(t,o,p),o},t.promisifyAll=function(t,e){if("function"!=typeof t&&"object"!=typeof t)throw new c("the target of promisifyAll must be an object or a function\n\n    See http://goo.gl/9ITlV0\n");var r=(e=Object(e)).suffix;"string"!=typeof r&&(r="Async");var o=e.filter;"function"!=typeof o&&(o=h);var i=e.promisifier;if("function"!=typeof i&&(i=_),!n.isIdentifier(r))throw new RangeError("suffix must be a valid identifier\n\n    See http://goo.gl/8FZo5V\n");for(var s=n.inheritedDataKeys(t),a=0;a<s.length;++a){var l=t[s[a]];"constructor"!==s[a]&&n.isClass(l)&&(v(l.prototype,r,o,i),v(l,r,o,i))}return v(t,r,o,i)}})}function oe(){return Lt?qt:(Lt=1,qt=function(t,e){var r=T(),n=t.TimeoutError,o=function(t){return i(+this).thenReturn(t)},i=t.delay=function(r,n){if(void 0===n){n=r,r=void 0;var i=new t(e);return setTimeout((function(){i._fulfill()}),n),i}return n=+n,t.resolve(r)._then(o,null,null,n,void 0)};function s(t){var e=this;return e instanceof Number&&(e=+e),clearTimeout(e),t}function a(t){var e=this;throw e instanceof Number&&(e=+e),clearTimeout(e),t}t.prototype.delay=function(t){return i(this,t)},t.prototype.timeout=function(t,e){t=+t;var o=this.then().cancellable();o._cancellationParent=this;var i=setTimeout((function(){!function(t,e){var o;t.isPending()&&(!r.isPrimitive(e)&&e instanceof Error?o=e:("string"!=typeof e&&(e="operation timed out"),o=new n(e)),r.markAsOriginatingFromRejection(o),t._attachExtraTrace(o),t._cancel(o))}(o,e)}),t);return o._then(s,a,void 0,i,void 0)}})}(Wt=F).exports=function(){var t,e=function(){return new c("circular promise resolution chain\n\n    See http://goo.gl/LhFpo0\n")},r=function(){return new k.PromiseInspection(this._target())},n=function(t){return k.reject(new c(t))},o=T();t=o.isNode?function(){var t=process.domain;return void 0===t&&(t=null),t}:function(){return null},o.notEnumerableProp(k,"_getDomain",t);var i={},s=Qt(),a=Jt(),c=k.TypeError=a.TypeError;k.RangeError=a.RangeError,k.CancellationError=a.CancellationError,k.TimeoutError=a.TimeoutError,k.OperationalError=a.OperationalError,k.RejectionError=a.OperationalError,k.AggregateError=a.AggregateError;var l=function(){},u={},h={e:null},p=Gt()(k,l),f=(L?q:(L=1,q=function(t,e,r,n){var o=T().isArray;function i(r){var n,o=this._promise=new t(e);r instanceof t&&(n=r,o._propagateFrom(n,5)),this._values=r,this._length=0,this._totalResolved=0,this._init(void 0,-2)}return i.prototype.length=function(){return this._length},i.prototype.promise=function(){return this._promise},i.prototype._init=function e(i,s){var a=r(this._values,this._promise);if(a instanceof t){if(a=a._target(),this._values=a,!a._isFulfilled())return a._isPending()?void a._then(e,this._reject,void 0,this,s):void this._reject(a._reason());if(a=a._value(),!o(a)){var c=new t.TypeError("expecting an array, a promise or a thenable\n\n    See http://goo.gl/s8MMhc\n");return void this.__hardReject__(c)}}else if(!o(a))return void this._promise._reject(n("expecting an array, a promise or a thenable\n\n    See http://goo.gl/s8MMhc\n")._reason());if(0!==a.length){var l=this.getActualLength(a.length);this._length=l,this._values=this.shouldCopyValues()?new Array(l):this._values;for(var u=this._promise,h=0;h<l;++h){var p=this._isResolved(),f=r(a[h],u);f instanceof t?(f=f._target(),p?f._ignoreRejections():f._isPending()?f._proxyPromiseArray(this,h):f._isFulfilled()?this._promiseFulfilled(f._value(),h):this._promiseRejected(f._reason(),h)):p||this._promiseFulfilled(f,h)}}else-5===s?this._resolveEmptyArray():this._resolve(function(t){switch(t){case-2:return[];case-3:return{}}}(s))},i.prototype._isResolved=function(){return null===this._values},i.prototype._resolve=function(t){this._values=null,this._promise._fulfill(t)},i.prototype.__hardReject__=i.prototype._reject=function(t){this._values=null,this._promise._rejectCallback(t,!1,!0)},i.prototype._promiseProgressed=function(t,e){this._promise._progress({index:e,value:t})},i.prototype._promiseFulfilled=function(t,e){this._values[e]=t,++this._totalResolved>=this._length&&this._resolve(this._values)},i.prototype._promiseRejected=function(t,e){this._totalResolved++,this._reject(t)},i.prototype.shouldCopyValues=function(){return!0},i.prototype.getActualLength=function(t){return t},i}))(k,l,p,n),d=Xt()(),y=(V?W:(V=1,W=function(t,e){var r,n,o=t._getDomain,i=Qt(),s=Jt().Warning,a=T(),c=a.canAttachTrace,l=a.isNode&&(!!process.env.BLUEBIRD_DEBUG||"development"===process.env.NODE_ENV);return a.isNode&&0==process.env.BLUEBIRD_DEBUG&&(l=!1),l&&i.disableTrampolineIfNecessary(),t.prototype._ignoreRejections=function(){this._unsetRejectionIsUnhandled(),this._bitField=16777216|this._bitField},t.prototype._ensurePossibleRejectionHandled=function(){0==(16777216&this._bitField)&&(this._setRejectionIsUnhandled(),i.invokeLater(this._notifyUnhandledRejection,this,void 0))},t.prototype._notifyUnhandledRejectionIsHandled=function(){e.fireRejectionEvent("rejectionHandled",r,void 0,this)},t.prototype._notifyUnhandledRejection=function(){if(this._isRejectionUnhandled()){var t=this._getCarriedStackTrace()||this._settledValue;this._setUnhandledRejectionIsNotified(),e.fireRejectionEvent("unhandledRejection",n,t,this)}},t.prototype._setUnhandledRejectionIsNotified=function(){this._bitField=524288|this._bitField},t.prototype._unsetUnhandledRejectionIsNotified=function(){this._bitField=-524289&this._bitField},t.prototype._isUnhandledRejectionNotified=function(){return(524288&this._bitField)>0},t.prototype._setRejectionIsUnhandled=function(){this._bitField=2097152|this._bitField},t.prototype._unsetRejectionIsUnhandled=function(){this._bitField=-2097153&this._bitField,this._isUnhandledRejectionNotified()&&(this._unsetUnhandledRejectionIsNotified(),this._notifyUnhandledRejectionIsHandled())},t.prototype._isRejectionUnhandled=function(){return(2097152&this._bitField)>0},t.prototype._setCarriedStackTrace=function(t){this._bitField=1048576|this._bitField,this._fulfillmentHandler0=t},t.prototype._isCarryingStackTrace=function(){return(1048576&this._bitField)>0},t.prototype._getCarriedStackTrace=function(){return this._isCarryingStackTrace()?this._fulfillmentHandler0:void 0},t.prototype._captureStackTrace=function(){return l&&(this._trace=new e(this._peekContext())),this},t.prototype._attachExtraTrace=function(t,r){if(l&&c(t)){var n=this._trace;if(void 0!==n&&r&&(n=n._parent),void 0!==n)n.attachExtraTrace(t);else if(!t.__stackCleaned__){var o=e.parseStackAndMessage(t);a.notEnumerableProp(t,"stack",o.message+"\n"+o.stack.join("\n")),a.notEnumerableProp(t,"__stackCleaned__",!0)}}},t.prototype._warn=function(t){var r=new s(t),n=this._peekContext();if(n)n.attachExtraTrace(r);else{var o=e.parseStackAndMessage(r);r.stack=o.message+"\n"+o.stack.join("\n")}e.formatAndLogError(r,"")},t.onPossiblyUnhandledRejection=function(t){var e=o();n="function"==typeof t?null===e?t:e.bind(t):void 0},t.onUnhandledRejectionHandled=function(t){var e=o();r="function"==typeof t?null===e?t:e.bind(t):void 0},t.longStackTraces=function(){if(i.haveItemsQueued()&&!1===l)throw new Error("cannot enable long stack traces after promises have been created\n\n    See http://goo.gl/DT1qyG\n");(l=e.isSupported())&&i.disableTrampolineIfNecessary()},t.hasLongStackTraces=function(){return l&&e.isSupported()},e.isSupported()||(t.longStackTraces=function(){},l=!1),function(){return l}}))(k,d),_=(Q?K:(Q=1,K=function(t,e,r){var n=[];function o(){this._trace=new e(i())}function i(){var t=n.length-1;if(t>=0)return n[t]}return o.prototype._pushContext=function(){r()&&void 0!==this._trace&&n.push(this._trace)},o.prototype._popContext=function(){r()&&void 0!==this._trace&&n.pop()},t.prototype._peekContext=i,t.prototype._pushContext=o.prototype._pushContext,t.prototype._popContext=o.prototype._popContext,function(){if(r())return new o}}))(k,d,y),v=(G?J:(G=1,J=function(t){var e=T(),r=Jt(),n=e.tryCatch,o=e.errorObj,i=O().keys,s=r.TypeError;function a(t,e,r){this._instances=t,this._callback=e,this._promise=r}function c(t,e){var r={},a=n(t).call(r,e);return a===o?a:i(r).length?(o.e=new s("Catch filter must inherit from Error or be a simple predicate function\n\n    See http://goo.gl/o84o68\n"),o):a}return a.prototype.doFilter=function(e){for(var r=this._callback,i=this._promise._boundValue(),s=0,a=this._instances.length;s<a;++s){var l=this._instances[s],u=l===Error||null!=l&&l.prototype instanceof Error;if(u&&e instanceof l)return(h=n(r).call(i,e))===o?(t.e=h.e,t):h;if("function"==typeof l&&!u){var h,p=c(l,e);if(p===o){e=o.e;break}if(p)return(h=n(r).call(i,e))===o?(t.e=h.e,t):h}}return t.e=e,t},a}))(h),g=Yt(),m=g._nodebackForPromise,w=o.errorObj,b=o.tryCatch;function k(t){if("function"!=typeof t)throw new c("the promise constructor requires a resolver function\n\n    See http://goo.gl/EC22Yn\n");if(this.constructor!==k)throw new c("the promise constructor cannot be invoked directly\n\n    See http://goo.gl/KsIlge\n");this._bitField=0,this._fulfillmentHandler0=void 0,this._rejectionHandler0=void 0,this._progressHandler0=void 0,this._promise0=void 0,this._receiver0=void 0,this._settledValue=void 0,t!==l&&this._resolveFromResolver(t)}function E(t){var e=new k(l);e._fulfillmentHandler0=t,e._rejectionHandler0=t,e._progressHandler0=t,e._promise0=t,e._receiver0=t,e._settledValue=t}return k.prototype.toString=function(){return"[object Promise]"},k.prototype.caught=k.prototype.catch=function(t){var e=arguments.length;if(e>1){var r,n=new Array(e-1),o=0;for(r=0;r<e-1;++r){var i=arguments[r];if("function"!=typeof i)return k.reject(new c("Catch filter must inherit from Error or be a simple predicate function\n\n    See http://goo.gl/o84o68\n"));n[o++]=i}n.length=o;var s=new v(n,t=arguments[r],this);return this._then(void 0,s.doFilter,void 0,s,void 0)}return this._then(void 0,t,void 0,void 0,void 0)},k.prototype.reflect=function(){return this._then(r,r,void 0,this,void 0)},k.prototype.then=function(t,e,r){if(y()&&arguments.length>0&&"function"!=typeof t&&"function"!=typeof e){var n=".then() only accepts functions but was passed: "+o.classString(t);arguments.length>1&&(n+=", "+o.classString(e)),this._warn(n)}return this._then(t,e,r,void 0,void 0)},k.prototype.done=function(t,e,r){this._then(t,e,r,void 0,void 0)._setIsFinal()},k.prototype.spread=function(t,e){return this.all()._then(t,e,void 0,u,void 0)},k.prototype.isCancellable=function(){return!this.isResolved()&&this._cancellable()},k.prototype.toJSON=function(){var t={isFulfilled:!1,isRejected:!1,fulfillmentValue:void 0,rejectionReason:void 0};return this.isFulfilled()?(t.fulfillmentValue=this.value(),t.isFulfilled=!0):this.isRejected()&&(t.rejectionReason=this.reason(),t.isRejected=!0),t},k.prototype.all=function(){return new f(this).promise()},k.prototype.error=function(t){return this.caught(o.originatesFromRejection,t)},k.getNewLibraryCopy=Wt.exports,k.is=function(t){return t instanceof k},k.fromNode=function(t){var e=new k(l),r=b(t)(m(e));return r===w&&e._rejectCallback(r.e,!0,!0),e},k.all=function(t){return new f(t).promise()},k.defer=k.pending=function(){var t=new k(l);return new g(t)},k.cast=function(t){var e=p(t);if(!(e instanceof k)){var r=e;(e=new k(l))._fulfillUnchecked(r)}return e},k.resolve=k.fulfilled=k.cast,k.reject=k.rejected=function(t){var e=new k(l);return e._captureStackTrace(),e._rejectCallback(t,!0),e},k.setScheduler=function(t){if("function"!=typeof t)throw new c("fn must be a function\n\n    See http://goo.gl/916lJJ\n");var e=s._schedule;return s._schedule=t,e},k.prototype._then=function(e,r,n,o,i){var a=void 0!==i,c=a?i:new k(l);a||(c._propagateFrom(this,5),c._captureStackTrace());var u=this._target();u!==this&&(void 0===o&&(o=this._boundTo),a||c._setIsMigrated());var h=u._addCallbacks(e,r,n,c,o,t());return u._isResolved()&&!u._isSettlePromisesQueued()&&s.invoke(u._settlePromiseAtPostResolution,u,h),c},k.prototype._settlePromiseAtPostResolution=function(t){this._isRejectionUnhandled()&&this._unsetRejectionIsUnhandled(),this._settlePromiseAt(t)},k.prototype._length=function(){return 131071&this._bitField},k.prototype._isFollowingOrFulfilledOrRejected=function(){return(939524096&this._bitField)>0},k.prototype._isFollowing=function(){return 536870912==(536870912&this._bitField)},k.prototype._setLength=function(t){this._bitField=-131072&this._bitField|131071&t},k.prototype._setFulfilled=function(){this._bitField=268435456|this._bitField},k.prototype._setRejected=function(){this._bitField=134217728|this._bitField},k.prototype._setFollowing=function(){this._bitField=536870912|this._bitField},k.prototype._setIsFinal=function(){this._bitField=33554432|this._bitField},k.prototype._isFinal=function(){return(33554432&this._bitField)>0},k.prototype._cancellable=function(){return(67108864&this._bitField)>0},k.prototype._setCancellable=function(){this._bitField=67108864|this._bitField},k.prototype._unsetCancellable=function(){this._bitField=-67108865&this._bitField},k.prototype._setIsMigrated=function(){this._bitField=4194304|this._bitField},k.prototype._unsetIsMigrated=function(){this._bitField=-4194305&this._bitField},k.prototype._isMigrated=function(){return(4194304&this._bitField)>0},k.prototype._receiverAt=function(t){var e=0===t?this._receiver0:this[5*t-5+4];if(e!==i)return void 0===e&&this._isBound()?this._boundValue():e},k.prototype._promiseAt=function(t){return 0===t?this._promise0:this[5*t-5+3]},k.prototype._fulfillmentHandlerAt=function(t){return 0===t?this._fulfillmentHandler0:this[5*t-5+0]},k.prototype._rejectionHandlerAt=function(t){return 0===t?this._rejectionHandler0:this[5*t-5+1]},k.prototype._boundValue=function(){var t=this._boundTo;return void 0!==t&&t instanceof k?t.isFulfilled()?t.value():void 0:t},k.prototype._migrateCallbacks=function(t,e){var r=t._fulfillmentHandlerAt(e),n=t._rejectionHandlerAt(e),o=t._progressHandlerAt(e),s=t._promiseAt(e),a=t._receiverAt(e);s instanceof k&&s._setIsMigrated(),void 0===a&&(a=i),this._addCallbacks(r,n,o,s,a,null)},k.prototype._addCallbacks=function(t,e,r,n,o,i){var s=this._length();if(s>=131066&&(s=0,this._setLength(0)),0===s)this._promise0=n,void 0!==o&&(this._receiver0=o),"function"!=typeof t||this._isCarryingStackTrace()||(this._fulfillmentHandler0=null===i?t:i.bind(t)),"function"==typeof e&&(this._rejectionHandler0=null===i?e:i.bind(e)),"function"==typeof r&&(this._progressHandler0=null===i?r:i.bind(r));else{var a=5*s-5;this[a+3]=n,this[a+4]=o,"function"==typeof t&&(this[a+0]=null===i?t:i.bind(t)),"function"==typeof e&&(this[a+1]=null===i?e:i.bind(e)),"function"==typeof r&&(this[a+2]=null===i?r:i.bind(r))}return this._setLength(s+1),s},k.prototype._setProxyHandlers=function(t,e){var r=this._length();if(r>=131066&&(r=0,this._setLength(0)),0===r)this._promise0=e,this._receiver0=t;else{var n=5*r-5;this[n+3]=e,this[n+4]=t}this._setLength(r+1)},k.prototype._proxyPromiseArray=function(t,e){this._setProxyHandlers(t,e)},k.prototype._resolveCallback=function(t,r){if(!this._isFollowingOrFulfilledOrRejected()){if(t===this)return this._rejectCallback(e(),!1,!0);var n=p(t,this);if(!(n instanceof k))return this._fulfill(t);var o=1|(r?4:0);this._propagateFrom(n,o);var i=n._target();if(i._isPending()){for(var s=this._length(),a=0;a<s;++a)i._migrateCallbacks(this,a);this._setFollowing(),this._setLength(0),this._setFollowee(i)}else i._isFulfilled()?this._fulfillUnchecked(i._value()):this._rejectUnchecked(i._reason(),i._getCarriedStackTrace())}},k.prototype._rejectCallback=function(t,e,r){r||o.markAsOriginatingFromRejection(t);var n=o.ensureErrorObject(t),i=n===t;this._attachExtraTrace(n,!!e&&i),this._reject(t,i?void 0:n)},k.prototype._resolveFromResolver=function(t){var e=this;this._captureStackTrace(),this._pushContext();var r=!0,n=b(t)((function(t){null!==e&&(e._resolveCallback(t),e=null)}),(function(t){null!==e&&(e._rejectCallback(t,r),e=null)}));r=!1,this._popContext(),void 0!==n&&n===w&&null!==e&&(e._rejectCallback(n.e,!0,!0),e=null)},k.prototype._settlePromiseFromHandler=function(t,r,n,o){var i;if(!o._isRejected())if(o._pushContext(),i=r!==u||this._isRejected()?b(t).call(r,n):b(t).apply(this._boundValue(),n),o._popContext(),i===w||i===o||i===h){var s=i===o?e():i.e;o._rejectCallback(s,!1,!0)}else o._resolveCallback(i)},k.prototype._target=function(){for(var t=this;t._isFollowing();)t=t._followee();return t},k.prototype._followee=function(){return this._rejectionHandler0},k.prototype._setFollowee=function(t){this._rejectionHandler0=t},k.prototype._cleanValues=function(){this._cancellable()&&(this._cancellationParent=void 0)},k.prototype._propagateFrom=function(t,e){(1&e)>0&&t._cancellable()&&(this._setCancellable(),this._cancellationParent=t),(4&e)>0&&t._isBound()&&this._setBoundTo(t._boundTo)},k.prototype._fulfill=function(t){this._isFollowingOrFulfilledOrRejected()||this._fulfillUnchecked(t)},k.prototype._reject=function(t,e){this._isFollowingOrFulfilledOrRejected()||this._rejectUnchecked(t,e)},k.prototype._settlePromiseAt=function(t){var e=this._promiseAt(t),r=e instanceof k;if(r&&e._isMigrated())return e._unsetIsMigrated(),s.invoke(this._settlePromiseAt,this,t);var n=this._isFulfilled()?this._fulfillmentHandlerAt(t):this._rejectionHandlerAt(t),o=this._isCarryingStackTrace()?this._getCarriedStackTrace():void 0,i=this._settledValue,a=this._receiverAt(t);this._clearCallbackDataAtIndex(t),"function"==typeof n?r?this._settlePromiseFromHandler(n,a,i,e):n.call(a,i,e):a instanceof f?a._isResolved()||(this._isFulfilled()?a._promiseFulfilled(i,e):a._promiseRejected(i,e)):r&&(this._isFulfilled()?e._fulfill(i):e._reject(i,o)),t>=4&&4==(31&t)&&s.invokeLater(this._setLength,this,0)},k.prototype._clearCallbackDataAtIndex=function(t){if(0===t)this._isCarryingStackTrace()||(this._fulfillmentHandler0=void 0),this._rejectionHandler0=this._progressHandler0=this._receiver0=this._promise0=void 0;else{var e=5*t-5;this[e+3]=this[e+4]=this[e+0]=this[e+1]=this[e+2]=void 0}},k.prototype._isSettlePromisesQueued=function(){return-1073741824==(-1073741824&this._bitField)},k.prototype._setSettlePromisesQueued=function(){this._bitField=-1073741824|this._bitField},k.prototype._unsetSettlePromisesQueued=function(){this._bitField=1073741823&this._bitField},k.prototype._queueSettlePromises=function(){s.settlePromises(this),this._setSettlePromisesQueued()},k.prototype._fulfillUnchecked=function(t){if(t===this){var r=e();return this._attachExtraTrace(r),this._rejectUnchecked(r,void 0)}this._setFulfilled(),this._settledValue=t,this._cleanValues(),this._length()>0&&this._queueSettlePromises()},k.prototype._rejectUncheckedCheckError=function(t){var e=o.ensureErrorObject(t);this._rejectUnchecked(t,e===t?void 0:e)},k.prototype._rejectUnchecked=function(t,r){if(t===this){var n=e();return this._attachExtraTrace(n),this._rejectUnchecked(n)}this._setRejected(),this._settledValue=t,this._cleanValues(),this._isFinal()?s.throwLater((function(t){throw"stack"in t&&s.invokeFirst(d.unhandledRejection,void 0,t),t}),void 0===r?t:r):(void 0!==r&&r!==t&&this._setCarriedStackTrace(r),this._length()>0?this._queueSettlePromises():this._ensurePossibleRejectionHandled())},k.prototype._settlePromises=function(){this._unsetSettlePromisesQueued();for(var t=this._length(),e=0;e<t;e++)this._settlePromiseAt(e)},o.notEnumerableProp(k,"_makeSelfResolutionError",e),(tt?Z:(tt=1,Z=function(t,e){var r=T(),n=Qt(),o=r.tryCatch,i=r.errorObj;t.prototype.progressed=function(t){return this._then(void 0,void 0,t,void 0,void 0)},t.prototype._progress=function(t){this._isFollowingOrFulfilledOrRejected()||this._target()._progressUnchecked(t)},t.prototype._progressHandlerAt=function(t){return 0===t?this._progressHandler0:this[(t<<2)+t-5+2]},t.prototype._doProgressWith=function(e){var n=e.value,s=e.handler,a=e.promise,c=e.receiver,l=o(s).call(c,n);if(l===i){if(null!=l.e&&"StopProgressPropagation"!==l.e.name){var u=r.canAttachTrace(l.e)?l.e:new Error(r.toString(l.e));a._attachExtraTrace(u),a._progress(l.e)}}else l instanceof t?l._then(a._progress,null,null,a,void 0):a._progress(l)},t.prototype._progressUnchecked=function(r){for(var o=this._length(),i=this._progress,s=0;s<o;s++){var a=this._progressHandlerAt(s),c=this._promiseAt(s);if(c instanceof t)"function"==typeof a?n.invoke(this._doProgressWith,this,{handler:a,promise:c,receiver:this._receiverAt(s),value:r}):n.invoke(i,c,r);else{var l=this._receiverAt(s);"function"==typeof a?a.call(l,r,c):l instanceof e&&!l._isResolved()&&l._promiseProgressed(r,c)}}}}))(k,f),(rt?et:(rt=1,et=function(t,e,r,n){var o=T(),i=o.tryCatch;t.method=function(r){if("function"!=typeof r)throw new t.TypeError("fn must be a function\n\n    See http://goo.gl/916lJJ\n");return function(){var n=new t(e);n._captureStackTrace(),n._pushContext();var o=i(r).apply(this,arguments);return n._popContext(),n._resolveFromSyncValue(o),n}},t.attempt=t.try=function(r,s,a){if("function"!=typeof r)return n("fn must be a function\n\n    See http://goo.gl/916lJJ\n");var c=new t(e);c._captureStackTrace(),c._pushContext();var l=o.isArray(s)?i(r).apply(a,s):i(r).call(a,s);return c._popContext(),c._resolveFromSyncValue(l),c},t.prototype._resolveFromSyncValue=function(t){t===o.errorObj?this._rejectCallback(t.e,!1,!0):this._resolveCallback(t,!0)}}))(k,l,p,n),(ot?nt:(ot=1,nt=function(t,e,r){var n=function(t,e){this._reject(e)},o=function(t,e){e.promiseRejectionQueued=!0,e.bindingPromise._then(n,n,null,this,t)},i=function(t,e){this._isPending()&&this._resolveCallback(e.target)},s=function(t,e){e.promiseRejectionQueued||this._reject(t)};t.prototype.bind=function(n){var a=r(n),c=new t(e);c._propagateFrom(this,1);var l=this._target();if(c._setBoundTo(a),a instanceof t){var u={promiseRejectionQueued:!1,promise:c,target:l,bindingPromise:a};l._then(e,o,c._progress,c,u),a._then(i,s,c._progress,c,u)}else c._resolveCallback(l);return c},t.prototype._setBoundTo=function(t){void 0!==t?(this._bitField=131072|this._bitField,this._boundTo=t):this._bitField=-131073&this._bitField},t.prototype._isBound=function(){return 131072==(131072&this._bitField)},t.bind=function(n,o){var i=r(n),s=new t(e);return s._setBoundTo(i),i instanceof t?i._then((function(){s._resolveCallback(o)}),s._reject,s._progress,s,null):s._resolveCallback(o),s}}))(k,l,p),(st?it:(st=1,it=function(t,e,r){var n=T(),o=n.isPrimitive,i=n.thrower;function s(){return this}function a(){throw this}function c(t,e,r){var n,c;return n=o(e)?r?(c=e,function(){return c}):function(t){return function(){throw t}}(e):r?s:a,t._then(n,i,void 0,e,void 0)}function l(n){var o=this.promise,i=this.handler,s=o._isBound()?i.call(o._boundValue()):i();if(void 0!==s){var a=r(s,o);if(a instanceof t)return c(a=a._target(),n,o.isFulfilled())}return o.isRejected()?(e.e=n,e):n}function u(e){var n=this.promise,o=this.handler,i=n._isBound()?o.call(n._boundValue(),e):o(e);if(void 0!==i){var s=r(i,n);if(s instanceof t)return c(s=s._target(),e,!0)}return e}t.prototype._passThroughHandler=function(t,e){if("function"!=typeof t)return this.then();var r={promise:this,handler:t};return this._then(e?l:u,e?l:void 0,void 0,r,void 0)},t.prototype.lastly=t.prototype.finally=function(t){return this._passThroughHandler(t,!0)},t.prototype.tap=function(t){return this._passThroughHandler(t,!1)}}))(k,h,p),function(){if(ct)return at;ct=1;var t=T().isPrimitive;return at=function(e){var r=function(){return this},n=function(){throw this},o=function(){},i=function(){throw void 0},s=function(t,e){return 1===e?function(){throw t}:2===e?function(){return t}:void 0};e.prototype.return=e.prototype.thenReturn=function(n){return void 0===n?this.then(o):t(n)?this._then(s(n,2),void 0,void 0,void 0,void 0):(n instanceof e&&n._ignoreRejections(),this._then(r,void 0,void 0,n,void 0))},e.prototype.throw=e.prototype.thenThrow=function(e){return void 0===e?this.then(i):t(e)?this._then(s(e,1),void 0,void 0,void 0,void 0):this._then(n,void 0,void 0,e,void 0)}}}()(k),Zt()(k),(pt?ht:(pt=1,ht=function(t,e,r,n){var o=T(),i=o.canEvaluate,s=o.tryCatch,a=o.errorObj;if(i){for(var c=function(t){return new Function("value","holder","                             \n\t            'use strict';                                                    \n\t            holder.pIndex = value;                                           \n\t            holder.checkFulfillment(this);                                   \n\t            ".replace(/Index/g,t))},l=function(t){for(var e=[],r=1;r<=t;++r)e.push("holder.p"+r);return new Function("holder","                                      \n\t            'use strict';                                                    \n\t            var callback = holder.fn;                                        \n\t            return callback(values);                                         \n\t            ".replace(/values/g,e.join(", ")))},u=[],h=[void 0],p=1;p<=5;++p)u.push(c(p)),h.push(l(p));var f=function(t,e){this.p1=this.p2=this.p3=this.p4=this.p5=null,this.fn=e,this.total=t,this.now=0};f.prototype.callers=h,f.prototype.checkFulfillment=function(t){var e=this.now;e++;var r=this.total;if(e>=r){var n=this.callers[r];t._pushContext();var o=s(n)(this);t._popContext(),o===a?t._rejectCallback(o.e,!1,!0):t._resolveCallback(o)}else this.now=e};var d=function(t){this._reject(t)}}t.join=function(){var o,s=arguments.length-1;if(s>0&&"function"==typeof arguments[s]&&(o=arguments[s],s<6&&i)){(v=new t(n))._captureStackTrace();for(var a=new f(s,o),c=u,l=0;l<s;++l){var h=r(arguments[l],v);h instanceof t?(h=h._target())._isPending()?h._then(c[l],d,void 0,v,a):h._isFulfilled()?c[l].call(v,h._value(),a):v._reject(h._reason()):c[l].call(v,h,a)}return v}for(var p=arguments.length,y=new Array(p),_=0;_<p;++_)y[_]=arguments[_];o&&y.pop();var v=new e(y).promise();return void 0!==o?v.spread(o):v}}))(k,f,p,l),k.version="2.11.0",k.Promise=k,(dt?ft:(dt=1,ft=function(t,e,r,n,o){var i=t._getDomain,s=Qt(),a=T(),c=a.tryCatch,l=a.errorObj,u={},h=[];function p(t,e,r,n){this.constructor$(t),this._promise._captureStackTrace();var a=i();this._callback=null===a?e:a.bind(e),this._preservedValues=n===o?new Array(this.length()):null,this._limit=r,this._inFlight=0,this._queue=r>=1?[]:h,s.invoke(f,this,void 0)}function f(){this._init$(void 0,-2)}function d(t,e,r,n){var o="object"==typeof r&&null!==r?r.concurrency:0;return new p(t,e,o="number"==typeof o&&isFinite(o)&&o>=1?o:0,n)}a.inherits(p,e),p.prototype._init=function(){},p.prototype._promiseFulfilled=function(e,r){var o=this._values,i=this.length(),s=this._preservedValues,a=this._limit;if(o[r]===u){if(o[r]=e,a>=1&&(this._inFlight--,this._drainQueue(),this._isResolved()))return}else{if(a>=1&&this._inFlight>=a)return o[r]=e,void this._queue.push(r);null!==s&&(s[r]=e);var h=this._callback,p=this._promise._boundValue();this._promise._pushContext();var f=c(h).call(p,e,r,i);if(this._promise._popContext(),f===l)return this._reject(f.e);var d=n(f,this._promise);if(d instanceof t){if((d=d._target())._isPending())return a>=1&&this._inFlight++,o[r]=u,d._proxyPromiseArray(this,r);if(!d._isFulfilled())return this._reject(d._reason());f=d._value()}o[r]=f}++this._totalResolved>=i&&(null!==s?this._filter(o,s):this._resolve(o))},p.prototype._drainQueue=function(){for(var t=this._queue,e=this._limit,r=this._values;t.length>0&&this._inFlight<e;){if(this._isResolved())return;var n=t.pop();this._promiseFulfilled(r[n],n)}},p.prototype._filter=function(t,e){for(var r=e.length,n=new Array(r),o=0,i=0;i<r;++i)t[i]&&(n[o++]=e[i]);n.length=o,this._resolve(n)},p.prototype.preservedValues=function(){return this._preservedValues},t.prototype.map=function(t,e){return"function"!=typeof t?r("fn must be a function\n\n    See http://goo.gl/916lJJ\n"):d(this,t,e,null).promise()},t.map=function(t,e,n,o){return"function"!=typeof e?r("fn must be a function\n\n    See http://goo.gl/916lJJ\n"):d(t,e,n,o).promise()}}))(k,f,n,p,l),(_t?yt:(_t=1,yt=function(t){var e=Jt(),r=Qt(),n=e.CancellationError;t.prototype._cancel=function(t){if(!this.isCancellable())return this;for(var e,r=this;void 0!==(e=r._cancellationParent)&&e.isCancellable();)r=e;this._unsetCancellable(),r._target()._rejectCallback(t,!1,!0)},t.prototype.cancel=function(t){return this.isCancellable()?(void 0===t&&(t=new n),r.invokeLater(this._cancel,this,t),this):this},t.prototype.cancellable=function(){return this._cancellable()||(r.enableTrampoline(),this._setCancellable(),this._cancellationParent=void 0),this},t.prototype.uncancellable=function(){var t=this.then();return t._unsetCancellable(),t},t.prototype.fork=function(t,e,r){var n=this._then(t,e,r,void 0,void 0);return n._setCancellable(),n._cancellationParent=void 0,n}}))(k),te()(k,n,p,_),ee()(k,n,l,p),(kt?bt:(kt=1,bt=function(t){var e=T(),r=Qt(),n=e.tryCatch,o=e.errorObj;function i(t,i){if(!e.isArray(t))return s.call(this,t,i);var a=n(i).apply(this._boundValue(),[null].concat(t));a===o&&r.throwLater(a.e)}function s(t,e){var i=this._boundValue(),s=void 0===t?n(e).call(i,null):n(e).call(i,null,t);s===o&&r.throwLater(s.e)}function a(t,e){if(!t){var i=this._target()._getCarriedStackTrace();i.cause=t,t=i}var s=n(e).call(this._boundValue(),t);s===o&&r.throwLater(s.e)}t.prototype.asCallback=t.prototype.nodeify=function(t,e){if("function"==typeof t){var r=s;void 0!==e&&Object(e).spread&&(r=i),this._then(r,a,void 0,this,t)}return this}}))(k),function(){if(Ct)return Et;Ct=1;var t=Object.create;if(t){var e=t(null),r=t(null);e[" size"]=r[" size"]=0}return Et=function(t){var n,o,i=T(),s=i.canEvaluate,a=i.isIdentifier,c=function(t){return new Function("ensureMethod","                                    \n\t        return function(obj) {                                               \n\t            'use strict'                                                     \n\t            var len = this.length;                                           \n\t            ensureMethod(obj, 'methodName');                                 \n\t            switch(len) {                                                    \n\t                case 1: return obj.methodName(this[0]);                      \n\t                case 2: return obj.methodName(this[0], this[1]);             \n\t                case 3: return obj.methodName(this[0], this[1], this[2]);    \n\t                case 0: return obj.methodName();                             \n\t                default:                                                     \n\t                    return obj.methodName.apply(obj, this);                  \n\t            }                                                                \n\t        };                                                                   \n\t        ".replace(/methodName/g,t))(h)},l=function(t){return new Function("obj","                                             \n\t        'use strict';                                                        \n\t        return obj.propertyName;                                             \n\t        ".replace("propertyName",t))},u=function(t,e,r){var n=r[t];if("function"!=typeof n){if(!a(t))return null;if(n=e(t),r[t]=n,r[" size"]++,r[" size"]>512){for(var o=Object.keys(r),i=0;i<256;++i)delete r[o[i]];r[" size"]=o.length-256}}return n};function h(e,r){var n;if(null!=e&&(n=e[r]),"function"!=typeof n){var o="Object "+i.classString(e)+" has no method '"+i.toString(r)+"'";throw new t.TypeError(o)}return n}function p(t){return h(t,this.pop()).apply(t,this)}function f(t){return t[this]}function d(t){var e=+this;return e<0&&(e=Math.max(0,e+t.length)),t[e]}n=function(t){return u(t,c,e)},o=function(t){return u(t,l,r)},t.prototype.call=function(t){for(var e=arguments.length,r=new Array(e-1),o=1;o<e;++o)r[o-1]=arguments[o];if(s){var i=n(t);if(null!==i)return this._then(i,void 0,void 0,r,void 0)}return r.push(t),this._then(p,void 0,void 0,r,void 0)},t.prototype.get=function(t){var e;if("number"==typeof t)e=d;else if(s){var r=o(t);e=null!==r?r:f}else e=f;return this._then(e,void 0,void 0,t,void 0)}}}()(k),(At?jt:(At=1,jt=function(t,e,r,n){var o=T(),i=o.isObject,s=O();function a(t){for(var e=s.keys(t),r=e.length,n=new Array(2*r),o=0;o<r;++o){var i=e[o];n[o]=t[i],n[o+r]=i}this.constructor$(n)}function c(e){var o,s=r(e);return i(s)?(o=s instanceof t?s._then(t.props,void 0,void 0,void 0,void 0):new a(s).promise(),s instanceof t&&o._propagateFrom(s,4),o):n("cannot await properties of a non-object\n\n    See http://goo.gl/OsFKC8\n")}o.inherits(a,e),a.prototype._init=function(){this._init$(void 0,-3)},a.prototype._promiseFulfilled=function(t,e){if(this._values[e]=t,++this._totalResolved>=this._length){for(var r={},n=this.length(),o=0,i=this.length();o<i;++o)r[this._values[o+n]]=this._values[o];this._resolve(r)}},a.prototype._promiseProgressed=function(t,e){this._promise._progress({key:this._values[e+this.length()],value:t})},a.prototype.shouldCopyValues=function(){return!1},a.prototype.getActualLength=function(t){return t>>1},t.prototype.props=function(){return c(this)},t.props=function(t){return c(t)}}))(k,f,p,n),re()(k,l,p,n),(Ot?xt:(Ot=1,xt=function(t,e,r,n,o){var i=t._getDomain,s=Qt(),a=T(),c=a.tryCatch,l=a.errorObj;function u(e,r,a,c){this.constructor$(e),this._promise._captureStackTrace(),this._preservedValues=c===o?[]:null,this._zerothIsAccum=void 0===a,this._gotAccum=!1,this._reducingIndex=this._zerothIsAccum?1:0,this._valuesPhase=void 0;var l=n(a,this._promise),u=!1,p=l instanceof t;p&&((l=l._target())._isPending()?l._proxyPromiseArray(this,-1):l._isFulfilled()?(a=l._value(),this._gotAccum=!0):(this._reject(l._reason()),u=!0)),p||this._zerothIsAccum||(this._gotAccum=!0);var f=i();this._callback=null===f?r:f.bind(r),this._accum=a,u||s.invoke(h,this,void 0)}function h(){this._init$(void 0,-5)}function p(t,e,n,o){return"function"!=typeof e?r("fn must be a function\n\n    See http://goo.gl/916lJJ\n"):new u(t,e,n,o).promise()}a.inherits(u,e),u.prototype._init=function(){},u.prototype._resolveEmptyArray=function(){(this._gotAccum||this._zerothIsAccum)&&this._resolve(null!==this._preservedValues?[]:this._accum)},u.prototype._promiseFulfilled=function(e,r){var o=this._values;o[r]=e;var i,s=this.length(),a=this._preservedValues,u=null!==a,h=this._gotAccum,p=this._valuesPhase;if(!p)for(p=this._valuesPhase=new Array(s),i=0;i<s;++i)p[i]=0;if(i=p[r],0===r&&this._zerothIsAccum?(this._accum=e,this._gotAccum=h=!0,p[r]=0===i?1:2):-1===r?(this._accum=e,this._gotAccum=h=!0):0===i?p[r]=1:(p[r]=2,this._accum=e),h){for(var f,d=this._callback,y=this._promise._boundValue(),_=this._reducingIndex;_<s;++_)if(2!==(i=p[_])){if(1!==i)return;if(e=o[_],this._promise._pushContext(),u?(a.push(e),f=c(d).call(y,e,_,s)):f=c(d).call(y,this._accum,e,_,s),this._promise._popContext(),f===l)return this._reject(f.e);var v=n(f,this._promise);if(v instanceof t){if((v=v._target())._isPending())return p[_]=4,v._proxyPromiseArray(this,_);if(!v._isFulfilled())return this._reject(v._reason());f=v._value()}this._reducingIndex=_+1,this._accum=f}else this._reducingIndex=_+1;this._resolve(u?a:this._accum)}},t.prototype.reduce=function(t,e){return p(this,t,e,null)},t.reduce=function(t,e,r,n){return p(t,e,r,n)}}))(k,f,n,p,l),(Pt?Tt:(Pt=1,Tt=function(t,e){var r=t.PromiseInspection;function n(t){this.constructor$(t)}T().inherits(n,e),n.prototype._promiseResolved=function(t,e){this._values[t]=e,++this._totalResolved>=this._length&&this._resolve(this._values)},n.prototype._promiseFulfilled=function(t,e){var n=new r;n._bitField=268435456,n._settledValue=t,this._promiseResolved(e,n)},n.prototype._promiseRejected=function(t,e){var n=new r;n._bitField=134217728,n._settledValue=t,this._promiseResolved(e,n)},t.settle=function(t){return new n(t).promise()},t.prototype.settle=function(){return new n(this).promise()}}))(k,f),(Dt?Rt:(Dt=1,Rt=function(t,e,r){var n=T(),o=Jt().RangeError,i=Jt().AggregateError,s=n.isArray;function a(t){this.constructor$(t),this._howMany=0,this._unwrap=!1,this._initialized=!1}function c(t,e){if((0|e)!==e||e<0)return r("expecting a positive integer\n\n    See http://goo.gl/1wAmHx\n");var n=new a(t),o=n.promise();return n.setHowMany(e),n.init(),o}n.inherits(a,e),a.prototype._init=function(){if(this._initialized)if(0!==this._howMany){this._init$(void 0,-5);var t=s(this._values);!this._isResolved()&&t&&this._howMany>this._canPossiblyFulfill()&&this._reject(this._getRangeError(this.length()))}else this._resolve([])},a.prototype.init=function(){this._initialized=!0,this._init()},a.prototype.setUnwrap=function(){this._unwrap=!0},a.prototype.howMany=function(){return this._howMany},a.prototype.setHowMany=function(t){this._howMany=t},a.prototype._promiseFulfilled=function(t){this._addFulfilled(t),this._fulfilled()===this.howMany()&&(this._values.length=this.howMany(),1===this.howMany()&&this._unwrap?this._resolve(this._values[0]):this._resolve(this._values))},a.prototype._promiseRejected=function(t){if(this._addRejected(t),this.howMany()>this._canPossiblyFulfill()){for(var e=new i,r=this.length();r<this._values.length;++r)e.push(this._values[r]);this._reject(e)}},a.prototype._fulfilled=function(){return this._totalResolved},a.prototype._rejected=function(){return this._values.length-this.length()},a.prototype._addRejected=function(t){this._values.push(t)},a.prototype._addFulfilled=function(t){this._values[this._totalResolved++]=t},a.prototype._canPossiblyFulfill=function(){return this.length()-this._rejected()},a.prototype._getRangeError=function(t){var e="Input array must contain at least "+this._howMany+" items but contains only "+t+" items";return new o(e)},a.prototype._resolveEmptyArray=function(){this._reject(this._getRangeError(0))},t.some=function(t,e){return c(t,e)},t.prototype.some=function(t){return c(this,t)},t._SomePromiseArray=a}))(k,f,n),ne()(k,l),(Ut?Nt:(Ut=1,Nt=function(t){var e=t._SomePromiseArray;function r(t){var r=new e(t),n=r.promise();return r.setHowMany(1),r.setUnwrap(),r.init(),n}t.any=function(t){return r(t)},t.prototype.any=function(){return r(this)}}))(k),(zt?Mt:(zt=1,Mt=function(t,e){var r=t.reduce;t.prototype.each=function(t){return r(this,t,null,e)},t.each=function(t,n){return r(t,n,null,e)}}))(k,l),oe()(k,l),($t?Ht:($t=1,Ht=function(t,e){var r=t.map;t.prototype.filter=function(t,n){return r(this,t,n,e)},t.filter=function(t,n,o){return r(t,n,o,e)}}))(k,l),o.toFastProperties(k),o.toFastProperties(k.prototype),E({a:1}),E({b:2}),E({c:3}),E(1),E((function(){})),E(void 0),E(!1),E(new k(l)),d.setBounds(s.firstLineError,o.lastLineError),k},"undefined"!=typeof Promise&&(Vt=Promise);var ie=F.exports();ie.noConflict=function(){try{Promise===ie&&(Promise=Vt)}catch(t){}return ie};var se=ie,ae="object"==typeof e&&e&&e.Object===Object&&e,ce="object"==typeof self&&self&&self.Object===Object&&self,le=(ae||ce||Function("return this")()).isFinite;var ue=function(t){return"number"==typeof t&&le(t)};const he={blue:{50:"#E4F0F6",100:"#BCD9EA",200:"#8BBDD9",300:"#5BA4CF",400:"#298FCA",500:"#0079BF",600:"#026AA7",700:"#055A8C",800:"#094C72",900:"#0C3953"},green:{50:"#EEF6EC",100:"#D6ECD2",200:"#B7DDB0",300:"#99D18F",400:"#7BC86C",500:"#61BD4F",600:"#5AAC44",700:"#519839",800:"#49852E",900:"#3F6F21"},orange:{50:"#FDF5EC",100:"#FCE8D2",200:"#FAD8B0",300:"#FDC788",400:"#FFB968",500:"#FFAB4A",600:"#E99E40",700:"#D29034",800:"#BB8129",900:"#A0711C"},red:{50:"#FBEDEB",100:"#F5D3CE",200:"#EFB3AB",300:"#EC9488",400:"#EF7564",500:"#EB5A46",600:"#CF513D",700:"#B04632",800:"#933B27",900:"#6E2F1A"},yellow:{50:"#FDFAE5",100:"#FAF3C0",200:"#F5EA92",300:"#F3E260",400:"#F5DD29",500:"#F2D600",600:"#E6C60D",700:"#D9B51C",800:"#CCA42B",900:"#BD903C"},purple:{50:"#F7F0FA",100:"#EDDBF4",200:"#DFC0EB",300:"#D5A6E6",400:"#CD8DE5",500:"#C377E0",600:"#A86CC1",700:"#89609E",800:"#6C547B",900:"#484553"},pink:{50:"#FEF2F9",100:"#FCDEF0",200:"#FAC6E5",300:"#FFB0E1",400:"#FF95D6",500:"#FF80CE",600:"#E76EB1",700:"#CD5A91",800:"#B44772",900:"#96304C"},sky:{50:"#E4F7FA",100:"#BDECF3",200:"#8FDFEB",300:"#5DD3E5",400:"#29CCE5",500:"#00C2E0",600:"#00AECC",700:"#0098B7",800:"#0082A0",900:"#006988"},lime:{50:"#ECFBF3",100:"#D3F6E4",200:"#B3F1D0",300:"#90ECC1",400:"#6DECA9",500:"#51E898",600:"#4FD683",700:"#4DC26B",800:"#4CAF54",900:"#4A9839"},gray:{50:"#F8F9F9",100:"#EDEFF0",200:"#E2E4E6",300:"#D6DADC",400:"#CDD2D4",500:"#C4C9CC",600:"#B6BBBF",700:"#A5ACB0",800:"#959DA1",900:"#838C91"},black:{50:"#C1C7D0",100:"#7A869A",200:"#6B778C",300:"#5E6C84",400:"#505F79",500:"#42526E",600:"#344563",700:"#253858",800:"#172B4D",900:"#091E42"},"business-blue":{50:"#EDEFF4",100:"#D2D7E5",200:"#B2B9D0",300:"#838FB5",400:"#6170A1",500:"#42548E",600:"#3E4D80",700:"#3A476F",800:"#36405F",900:"#30364C"},shades:{0:"#FFFFFF",10:"#FAFCFC",20:"#F5F6F7",30:"#EBEEF0",40:"#DFE3E6",50:"#C2CCD1",60:"#B3BAC5",70:"#A6B3BA",80:"#97A7B0",90:"#899AA3",100:"#798D99",200:"#6B808C",300:"#5E7785",400:"#516B7A",500:"#425E6E",600:"#355263",700:"#254659",800:"#17394D",900:"#092D42"}};he.neutrals=he.shades;const pe=(t,e)=>{if(!t||"string"!=typeof t)throw new Error("Invalid color name");const r=t.toLowerCase();if(!he[r])throw new Error("Unknown color name: "+r);const n=ue(e)?e:500;if(!he[r][n])throw new Error("Unknown color weight: "+n);return he[r][n]},fe=t=>{if(!t||"string"!=typeof t)throw new Error("Invalid named color string");if(/^#[a-fA-F0-9]{6}$/.test(t))return t;const e=/^([a-zA-Z-]+)(#[1-9]?0?0)?$/.exec(t);if(!e)throw new Error("Invalid accentColor provided");const r=e[1];let n=500;return e[2]&&(n=parseInt(e[2].substring(1),10)),pe(r,n)};function de(t){if(!t)return null;for(let e=0;e<t.length;e+=1){const r=t[e];if("number"!=typeof r||r%1!=0||r>255||r<0)throw new Error("Invalid bytes. Bytes must be 0 - 255")}const e=new Uint8Array(t),r=[];for(let t=0;t<e.length;t+=1){let n=e[t].toString(16);n.length<2&&(n="0"+n),r.push(n)}return r.join("")}function ye(t){if(!t)throw new Error("Invalid hexString");const e=t.toLowerCase();if(!/^[0-9a-f]+$/.test(e)||e.length%2!=0)throw new Error("Invalid hexString");const r=new Uint8Array(e.length/2);for(let t=0;t<e.length;t+=2){const n=parseInt(e.substr(t,2),16);if(isNaN(n))throw new Error("Invalid hexString");r[t/2]=n}return r}function _e(t,e,r){return e<=t&&t<=r}function ve(t){if(void 0===t)return{};if(t===Object(t))return t;throw TypeError("Could not convert argument to dictionary")}function ge(t){this.tokens=[].slice.call(t)}ge.prototype={endOfStream:function(){return!this.tokens.length},read:function(){return this.tokens.length?this.tokens.shift():-1},prepend:function(t){if(Array.isArray(t))for(var e=t;e.length;)this.tokens.unshift(e.pop());else this.tokens.unshift(t)},push:function(t){if(Array.isArray(t))for(var e=t;e.length;)this.tokens.push(e.shift());else this.tokens.push(t)}};var me=-1;function we(t,e){if(t)throw TypeError("Decoder error");return e||65533}var be="utf-8";function ke(t,e){if(!(this instanceof ke))return new ke(t,e);if((t=void 0!==t?String(t).toLowerCase():be)!==be)throw new Error("Encoding not supported. Only utf-8 is supported");e=ve(e),this._streaming=!1,this._BOMseen=!1,this._decoder=null,this._fatal=Boolean(e.fatal),this._ignoreBOM=Boolean(e.ignoreBOM),Object.defineProperty(this,"encoding",{value:"utf-8"}),Object.defineProperty(this,"fatal",{value:this._fatal}),Object.defineProperty(this,"ignoreBOM",{value:this._ignoreBOM})}function Ee(t,e){if(!(this instanceof Ee))return new Ee(t,e);if((t=void 0!==t?String(t).toLowerCase():be)!==be)throw new Error("Encoding not supported. Only utf-8 is supported");e=ve(e),this._streaming=!1,this._encoder=null,this._options={fatal:Boolean(e.fatal)},Object.defineProperty(this,"encoding",{value:"utf-8"})}function Ce(t){var e=t.fatal,r=0,n=0,o=0,i=128,s=191;this.handler=function(t,a){if(-1===a&&0!==o)return o=0,we(e);if(-1===a)return me;if(0===o){if(_e(a,0,127))return a;if(_e(a,194,223))o=1,r=a-192;else if(_e(a,224,239))224===a&&(i=160),237===a&&(s=159),o=2,r=a-224;else{if(!_e(a,240,244))return we(e);240===a&&(i=144),244===a&&(s=143),o=3,r=a-240}return r<<=6*o,null}if(!_e(a,i,s))return r=o=n=0,i=128,s=191,t.prepend(a),we(e);if(i=128,s=191,r+=a-128<<6*(o-(n+=1)),n!==o)return null;var c=r;return r=o=n=0,c}}function je(t){t.fatal,this.handler=function(t,e){if(-1===e)return me;if(_e(e,0,127))return e;var r,n;_e(e,128,2047)?(r=1,n=192):_e(e,2048,65535)?(r=2,n=224):_e(e,65536,1114111)&&(r=3,n=240);for(var o=[(e>>6*r)+n];r>0;){var i=e>>6*(r-1);o.push(128|63&i),r-=1}return o}}ke.prototype={decode:function(t,e){var r;r="object"==typeof t&&t instanceof ArrayBuffer?new Uint8Array(t):"object"==typeof t&&"buffer"in t&&t.buffer instanceof ArrayBuffer?new Uint8Array(t.buffer,t.byteOffset,t.byteLength):new Uint8Array(0),e=ve(e),this._streaming||(this._decoder=new Ce({fatal:this._fatal}),this._BOMseen=!1),this._streaming=Boolean(e.stream);for(var n,o=new ge(r),i=[];!o.endOfStream()&&(n=this._decoder.handler(o,o.read()))!==me;)null!==n&&(Array.isArray(n)?i.push.apply(i,n):i.push(n));if(!this._streaming){do{if((n=this._decoder.handler(o,o.read()))===me)break;null!==n&&(Array.isArray(n)?i.push.apply(i,n):i.push(n))}while(!o.endOfStream());this._decoder=null}return i.length&&(-1===["utf-8"].indexOf(this.encoding)||this._ignoreBOM||this._BOMseen||(65279===i[0]?(this._BOMseen=!0,i.shift()):this._BOMseen=!0)),function(t){for(var e="",r=0;r<t.length;++r){var n=t[r];n<=65535?e+=String.fromCharCode(n):(n-=65536,e+=String.fromCharCode(55296+(n>>10),56320+(1023&n)))}return e}(i)}},Ee.prototype={encode:function(t,e){t=t?String(t):"",e=ve(e),this._streaming||(this._encoder=new je(this._options)),this._streaming=Boolean(e.stream);for(var r,n=[],o=new ge(function(t){for(var e=String(t),r=e.length,n=0,o=[];n<r;){var i=e.charCodeAt(n);if(i<55296||i>57343)o.push(i);else if(56320<=i&&i<=57343)o.push(65533);else if(55296<=i&&i<=56319)if(n===r-1)o.push(65533);else{var s=t.charCodeAt(n+1);if(56320<=s&&s<=57343){var a=1023&i,c=1023&s;o.push(65536+(a<<10)+c),n+=1}else o.push(65533)}n+=1}return o}(t));!o.endOfStream()&&(r=this._encoder.handler(o,o.read()))!==me;)Array.isArray(r)?n.push.apply(n,r):n.push(r);if(!this._streaming){for(;(r=this._encoder.handler(o,o.read()))!==me;)Array.isArray(r)?n.push.apply(n,r):n.push(r);this._encoder=null}return new Uint8Array(n)}};const Ae=t=>"function"==typeof t,Se=Ae(window.TextEncoder)?window.TextEncoder:Ee,Fe=Ae(window.TextDecoder)?window.TextDecoder:ke,xe="AES-CBC",Oe={name:xe,length:256},Te=!0,Pe=["encrypt","decrypt"],Re="object"==typeof window.crypto,De=!Re&&"object"==typeof window.msCrypto;let Ie;Re?Ie=null==window.crypto.subtle&&null!=window.crypto.webkitSubtle?window.crypto.webkitSubtle:window.crypto.subtle:De&&(Ie=window.msCrypto.subtle);const Be=t=>{const e=(new Se).encode(t);return new se(((t,r)=>{if(Re)Ie.digest({name:"SHA-256"},e).then((e=>t(de(e))));else if(De){const n=Ie.digest({name:"SHA-256"},e);n.oncomplete=e=>{t(de(e.target.result))},n.onerror=t=>{r(new Error("Error digesting text: "+t.type))}}else r(new Error("Browser not supported."))}))};var Ne={generateInitVector:()=>{if(Re&&"function"==typeof window.crypto.getRandomValues)return window.crypto.getRandomValues(new Uint8Array(16));if(De&&"function"==typeof window.msCrypto.getRandomValues)return window.msCrypto.getRandomValues(new Uint8Array(16));throw new Error("Browser not supported.")},generateAESCBCKey:()=>new se(((t,e)=>{if(Re)t(Ie.generateKey(Oe,Te,Pe));else if(De){const r=Ie.generateKey(Oe,Te,Pe);r.oncomplete=e=>{t(e.target.result)},r.onerror=t=>{e(new Error("Error generating key: "+t.type))}}else e(new Error("Browser not supported."))})),importAESCBCKeyFromRaw:t=>{const e=ye(t);return new se(((t,r)=>{if(Re)t(Ie.importKey("raw",e,xe,Te,Pe));else if(De){const n=Ie.importKey("raw",e,xe,Te,Pe);n.oncomplete=e=>{t(e.target.result)},n.onerror=t=>{r(new Error("Error importing key: "+t.type))}}else r(new Error("Browser not supported."))}))},exportAESCBCKeyToRaw:t=>new se(((e,r)=>{if(Re)Ie.exportKey("raw",t).then((t=>e(de(t))));else if(De){const n=Ie.exportKey("raw",t);n.oncomplete=t=>{e(de(t.target.result))},n.onerror=t=>{r(new Error("Error exporting key: "+t.type))}}else r(new Error("Browser not supported."))})),encryptSecret:(t,e,r)=>Be(r).then((n=>{const o=(new Se).encode(n+r);return Re?Ie.encrypt({name:xe,iv:t},e,o).then((t=>de(t))):De?new se(((r,n)=>{const i=Ie.encrypt({name:xe,iv:t},e,o);i.oncomplete=t=>{r(de(t.target.result))},i.onerror=t=>{n(new Error("Error encrypting secret: "+t.type))}})):se.reject(new Error("Browser not supported."))})),decryptSecret:(t,e,r)=>{const n=ye(r);return new se(((r,o)=>{if(Re)Ie.decrypt({name:xe,iv:t},e,n).then((t=>{r((new Fe).decode(t))})).catch((t=>{o(new Error("Decryption failed. Message: "+t.message))}));else if(De){const i=Ie.decrypt({name:xe,iv:t},e,n);i.oncomplete=t=>{r((new Fe).decode(t.target.result))},i.onerror=t=>{o(new Error("Decryption failed. Message: "+t.type))}}else o(new Error("Browser not supported."))})).then((t=>{const e=t.substring(0,64),r=t.substring(64);if(!/^[a-f0-9]{64}$/.test(e))throw new Error("Decryption failed. Unable to validate integrity.");return Be(r).then((t=>{if(t===e)return r;throw new Error("Decryption failed. Unable to validate integrity.")}))}))},sha256Digest:Be},Ue="__lodash_hash_undefined__",Me="[object Function]",ze="[object GeneratorFunction]",qe=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,Le=/^\w*$/,He=/^\./,$e=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,We=/\\(\\)?/g,Ve=/^\[object .+?Constructor\]$/,Ke="object"==typeof e&&e&&e.Object===Object&&e,Qe="object"==typeof self&&self&&self.Object===Object&&self,Je=Ke||Qe||Function("return this")();var Ge,Xe=Array.prototype,Ye=Function.prototype,Ze=Object.prototype,tr=Je["__core-js_shared__"],er=(Ge=/[^.]+$/.exec(tr&&tr.keys&&tr.keys.IE_PROTO||""))?"Symbol(src)_1."+Ge:"",rr=Ye.toString,nr=Ze.hasOwnProperty,or=Ze.toString,ir=RegExp("^"+rr.call(nr).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),sr=Je.Symbol,ar=Xe.splice,cr=mr(Je,"Map"),lr=mr(Object,"create"),ur=sr?sr.prototype:void 0,hr=ur?ur.toString:void 0;function pr(t){var e=-1,r=t?t.length:0;for(this.clear();++e<r;){var n=t[e];this.set(n[0],n[1])}}function fr(t){var e=-1,r=t?t.length:0;for(this.clear();++e<r;){var n=t[e];this.set(n[0],n[1])}}function dr(t){var e=-1,r=t?t.length:0;for(this.clear();++e<r;){var n=t[e];this.set(n[0],n[1])}}function yr(t,e){for(var r,n,o=t.length;o--;)if((r=t[o][0])===(n=e)||r!=r&&n!=n)return o;return-1}function _r(t,e){for(var r,n=0,o=(e=function(t,e){if(Er(t))return!1;var r=typeof t;if("number"==r||"symbol"==r||"boolean"==r||null==t||jr(t))return!0;return Le.test(t)||!qe.test(t)||null!=e&&t in Object(e)}(e,t)?[e]:Er(r=e)?r:wr(r)).length;null!=t&&n<o;)t=t[br(e[n++])];return n&&n==o?t:void 0}function vr(t){return!(!Cr(t)||(e=t,er&&er in e))&&(function(t){var e=Cr(t)?or.call(t):"";return e==Me||e==ze}(t)||function(t){var e=!1;if(null!=t&&"function"!=typeof t.toString)try{e=!!(t+"")}catch(t){}return e}(t)?ir:Ve).test(function(t){if(null!=t){try{return rr.call(t)}catch(t){}try{return t+""}catch(t){}}return""}(t));var e}function gr(t,e){var r,n,o=t.__data__;return("string"==(n=typeof(r=e))||"number"==n||"symbol"==n||"boolean"==n?"__proto__"!==r:null===r)?o["string"==typeof e?"string":"hash"]:o.map}function mr(t,e){var r=function(t,e){return null==t?void 0:t[e]}(t,e);return vr(r)?r:void 0}pr.prototype.clear=function(){this.__data__=lr?lr(null):{}},pr.prototype.delete=function(t){return this.has(t)&&delete this.__data__[t]},pr.prototype.get=function(t){var e=this.__data__;if(lr){var r=e[t];return r===Ue?void 0:r}return nr.call(e,t)?e[t]:void 0},pr.prototype.has=function(t){var e=this.__data__;return lr?void 0!==e[t]:nr.call(e,t)},pr.prototype.set=function(t,e){return this.__data__[t]=lr&&void 0===e?Ue:e,this},fr.prototype.clear=function(){this.__data__=[]},fr.prototype.delete=function(t){var e=this.__data__,r=yr(e,t);return!(r<0)&&(r==e.length-1?e.pop():ar.call(e,r,1),!0)},fr.prototype.get=function(t){var e=this.__data__,r=yr(e,t);return r<0?void 0:e[r][1]},fr.prototype.has=function(t){return yr(this.__data__,t)>-1},fr.prototype.set=function(t,e){var r=this.__data__,n=yr(r,t);return n<0?r.push([t,e]):r[n][1]=e,this},dr.prototype.clear=function(){this.__data__={hash:new pr,map:new(cr||fr),string:new pr}},dr.prototype.delete=function(t){return gr(this,t).delete(t)},dr.prototype.get=function(t){return gr(this,t).get(t)},dr.prototype.has=function(t){return gr(this,t).has(t)},dr.prototype.set=function(t,e){return gr(this,t).set(t,e),this};var wr=kr((function(t){var e;t=null==(e=t)?"":function(t){if("string"==typeof t)return t;if(jr(t))return hr?hr.call(t):"";var e=t+"";return"0"==e&&1/t==-1/0?"-0":e}(e);var r=[];return He.test(t)&&r.push(""),t.replace($e,(function(t,e,n,o){r.push(n?o.replace(We,"$1"):e||t)})),r}));function br(t){if("string"==typeof t||jr(t))return t;var e=t+"";return"0"==e&&1/t==-1/0?"-0":e}function kr(t,e){if("function"!=typeof t||e&&"function"!=typeof e)throw new TypeError("Expected a function");var r=function(){var n=arguments,o=e?e.apply(this,n):n[0],i=r.cache;if(i.has(o))return i.get(o);var s=t.apply(this,n);return r.cache=i.set(o,s),s};return r.cache=new(kr.Cache||dr),r}kr.Cache=dr;var Er=Array.isArray;function Cr(t){var e=typeof t;return!!t&&("object"==e||"function"==e)}function jr(t){return"symbol"==typeof t||function(t){return!!t&&"object"==typeof t}(t)&&"[object Symbol]"==or.call(t)}var Ar=function(t,e,r){var n=null==t?void 0:_r(t,e);return void 0===n?r:n},Sr={exports:{}};!function(t,e){var r="undefined"!=typeof Reflect?Reflect.construct:void 0,n=Object.defineProperty,o=Error.captureStackTrace;function i(t){void 0!==t&&n(this,"message",{configurable:!0,value:t,writable:!0});var e=this.constructor.name;void 0!==e&&e!==this.name&&n(this,"name",{configurable:!0,value:e,writable:!0}),o(this,this.constructor)}void 0===o&&(o=function(t){var e=new Error;n(t,"stack",{configurable:!0,get:function(){var t=e.stack;return n(this,"stack",{configurable:!0,value:t,writable:!0}),t},set:function(e){n(t,"stack",{configurable:!0,value:e,writable:!0})}})}),i.prototype=Object.create(Error.prototype,{constructor:{configurable:!0,value:i,writable:!0}});var s=function(){function t(t,e){return n(t,"name",{configurable:!0,value:e})}try{var e=function(){};if(t(e,"foo"),"foo"===e.name)return t}catch(t){}}();(t.exports=function(t,e){if(null==e||e===Error)e=i;else if("function"!=typeof e)throw new TypeError("super_ should be a function");var n;if("string"==typeof t)n=t,t=void 0!==r?function(){return r(e,arguments,this.constructor)}:function(){e.apply(this,arguments)},void 0!==s&&(s(t,n),n=void 0);else if("function"!=typeof t)throw new TypeError("constructor should be either a string or a function");t.super_=t.super=e;var o={constructor:{configurable:!0,value:t,writable:!0}};return void 0!==n&&(o.name={configurable:!0,value:n,writable:!0}),t.prototype=Object.create(e.prototype,o),t}).BaseError=i}(Sr);var Fr=Sr.exports;const xr="Error";var Or=(t,e)=>{const r=Fr([t,xr].join("::"));return e.forEach((e=>{r[e]=Fr([t,e].join("::"),r)})),r},Tr=Or("i18n",["ArgNotFound","InvalidResourceUrl","KeyNotFound","LoadLocalizerNotAFunction","LocaleNotFound","LocaleNotSpecified","LocalizerNotFound","MissingDefaultLocale","MissingResourceUrl","MissingSupportedLocales","UnableToParseArgs","UnableToParseAttrs","Unknown","UnsupportedKeyType"]);const Pr=(t,e,r)=>r.includes(t)?t:t.includes("-")?Pr(t.split("-")[0],e,r):e;class Rr{constructor(t){this.resourceDictionary=t}localize(t,e){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{dotNotation:!1};const n=null!=r&&r.dotNotation?Ar(this.resourceDictionary,t):this.resourceDictionary[t];if(null!=n){if(e){const o=null!=r&&r.dotNotation?/\{(\w+?(?:\.\w+?)*\w+?)\}/gi:/\{(\w+?)\}/gi;let i="",s=o.exec(n),a=0;for(;s;){s.index>a&&(i+=n.substring(a,s.index));const c=null!=r&&r.dotNotation?Ar(e,s[1]):e[s[1]];if(void 0===c)throw new Tr.ArgNotFound(`Arg: ${s[1]} was not defined for key: ${t}`);i+=c,a=s.index+s[0].length,s=o.exec(n)}return i+=n.substring(a),i}return n}throw new Tr.KeyNotFound("No resource defined for key: "+t)}}let Dr,Ir,Br="";var Nr=(t,e,r,n)=>se.try((()=>{let o;return o=t?Pr(t,e,r):e,o===Br&&Ir?Ir:(Dr||(Dr=new se(((t,e)=>{const r=new XMLHttpRequest;r.open("GET",((t,e)=>{if(!t.includes("{locale}"))throw new Tr.InvalidResourceUrl("ResourceUrl must specify where to place locale with {locale}");return t.replace("{locale}",e)})(n,o),!0),r.onload=()=>{try{if(200===r.status){const e=JSON.parse(r.responseText);return Ir=new Rr(e),Br=o,t(Ir)}return 404===r.status?e(new Tr.LocaleNotFound(o+" not found.")):e(new Tr.Unknown(`Unable to load locale: ${o}, status: ${r.status}`))}catch(t){return e(new Tr.Unknown(t.message))}},r.send()}))),Dr)})),Ur=(t,e)=>{const r=e||{};let n="";if(!t)return n="Unable to load a localizer without a locale",se.reject(new Tr.LocaleNotSpecified(n));if(window.localizer)return se.resolve();if(r.localizer)window.localizer=r.localizer;else{if(r.loadLocalizer)return"function"==typeof r.loadLocalizer?se.resolve(r.loadLocalizer(t)).then((t=>(window.localizer=t,se.resolve()))):(n="Specified loadLocalizer must be a function that returns a localizer or a Promise resolving to a localizer",se.reject(new Tr.LoadLocalizerNotAFunction(n)));if(r.localization){const{defaultLocale:e,supportedLocales:n,resourceUrl:o}=r.localization;return e?n?o?Nr(t,e,n,o).then((t=>(window.localizer=t,se.resolve()))):se.reject(new Tr.MissingResourceUrl("Missing resourceUrl")):se.reject(new Tr.MissingSupportedLocales("Missing supportedLocales")):se.reject(new Tr.MissingDefaultLocale("Missing defaultLocale"))}}return se.resolve()};const Mr=function(t,e){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{dotNotation:!1};if(window.localizer&&"function"==typeof window.localizer.localize)return window.localizer.localize(t,e,r);throw new Tr.LocalizerNotFound("No localizer available for localization.")},zr=function(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{dotNotation:!1};return t?t.map((t=>{if("string"==typeof t)return Mr(t,{},e);if(Array.isArray(t))return Mr(t[0],t[1],e);throw new Tr.UnsupportedKeyType("localizeKeys doesn't recognize the supplied key type: "+typeof t)})):[]},qr=function(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{dotNotation:!1};const r=t.querySelectorAll("[data-i18n-id],[data-i18n-attrs]");for(let t=0,n=r.length;t<n;t+=1){let n={};const o=r[t];if(o.dataset.i18nArgs)try{n=JSON.parse(o.dataset.i18nArgs)}catch(t){throw new Tr.UnableToParseArgs("Error parsing args. Error: "+t.message)}if(o.dataset.i18nId&&(o.textContent=Mr(o.dataset.i18nId,n,e)),o.dataset.i18nAttrs){let t;try{t=JSON.parse(o.dataset.i18nAttrs)}catch(t){throw new Tr.UnableToParseAttrs("Error parsing attrs. Error: "+t.message)}t&&t.placeholder&&(o.placeholder=Mr(t.placeholder,n,e))}}};var Lr=t=>{if(/^https?:\/\//.test(t))return t;const e=window.location.origin||`${window.location.protocol}//${window.location.host}`,r=window.location.pathname.replace(/[^/]+$/,"");return/^\/\//.test(t)?[e,t.substring(1)].join(""):/^\//.test(t)?[e,t].join(""):[e,r,t].join("")},Hr="__lodash_hash_undefined__",$r=9007199254740991,Wr="[object Arguments]",Vr=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,Kr=/^\w*$/,Qr=/^\./,Jr=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,Gr=/\\(\\)?/g,Xr=/^\[object .+?Constructor\]$/,Yr=/^(?:0|[1-9]\d*)$/,Zr="object"==typeof e&&e&&e.Object===Object&&e,tn="object"==typeof self&&self&&self.Object===Object&&self,en=Zr||tn||Function("return this")();var rn=Array.prototype,nn=Function.prototype,on=Object.prototype,sn=en["__core-js_shared__"],an=function(){var t=/[^.]+$/.exec(sn&&sn.keys&&sn.keys.IE_PROTO||"");return t?"Symbol(src)_1."+t:""}(),cn=nn.toString,ln=on.hasOwnProperty,un=on.toString,hn=RegExp("^"+cn.call(ln).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),pn=en.Symbol,fn=on.propertyIsEnumerable,dn=rn.splice,yn=An(en,"Map"),_n=An(Object,"create"),vn=pn?pn.prototype:void 0,gn=vn?vn.toString:void 0;function mn(t){var e=-1,r=t?t.length:0;for(this.clear();++e<r;){var n=t[e];this.set(n[0],n[1])}}function wn(t){var e=-1,r=t?t.length:0;for(this.clear();++e<r;){var n=t[e];this.set(n[0],n[1])}}function bn(t){var e=-1,r=t?t.length:0;for(this.clear();++e<r;){var n=t[e];this.set(n[0],n[1])}}function kn(t,e){for(var r,n,o=t.length;o--;)if((r=t[o][0])===(n=e)||r!=r&&n!=n)return o;return-1}function En(t,e){return null!=t&&ln.call(t,e)}function Cn(t){return!(!Dn(t)||(e=t,an&&an in e))&&(Pn(t)||function(t){var e=!1;if(null!=t&&"function"!=typeof t.toString)try{e=!!(t+"")}catch(t){}return e}(t)?hn:Xr).test(function(t){if(null!=t){try{return cn.call(t)}catch(t){}try{return t+""}catch(t){}}return""}(t));var e}function jn(t,e){var r,n,o=t.__data__;return("string"==(n=typeof(r=e))||"number"==n||"symbol"==n||"boolean"==n?"__proto__"!==r:null===r)?o["string"==typeof e?"string":"hash"]:o.map}function An(t,e){var r=function(t,e){return null==t?void 0:t[e]}(t,e);return Cn(r)?r:void 0}function Sn(t,e,r){for(var n,o,i=-1,s=(e=function(t,e){if(Tn(t))return!1;var r=typeof t;if("number"==r||"symbol"==r||"boolean"==r||null==t||Bn(t))return!0;return Kr.test(t)||!Vr.test(t)||null!=e&&t in Object(e)}(e,t)?[e]:Tn(n=e)?n:Fn(n)).length;++i<s;){var a=xn(e[i]);if(!(o=null!=t&&r(t,a)))break;t=t[a]}return o||!!(s=t?t.length:0)&&Rn(s)&&function(t,e){return!!(e=null==e?$r:e)&&("number"==typeof t||Yr.test(t))&&t>-1&&t%1==0&&t<e}(a,s)&&(Tn(t)||function(t){return function(t){return In(t)&&function(t){return null!=t&&Rn(t.length)&&!Pn(t)}(t)}(t)&&ln.call(t,"callee")&&(!fn.call(t,"callee")||un.call(t)==Wr)}(t))}mn.prototype.clear=function(){this.__data__=_n?_n(null):{}},mn.prototype.delete=function(t){return this.has(t)&&delete this.__data__[t]},mn.prototype.get=function(t){var e=this.__data__;if(_n){var r=e[t];return r===Hr?void 0:r}return ln.call(e,t)?e[t]:void 0},mn.prototype.has=function(t){var e=this.__data__;return _n?void 0!==e[t]:ln.call(e,t)},mn.prototype.set=function(t,e){return this.__data__[t]=_n&&void 0===e?Hr:e,this},wn.prototype.clear=function(){this.__data__=[]},wn.prototype.delete=function(t){var e=this.__data__,r=kn(e,t);return!(r<0)&&(r==e.length-1?e.pop():dn.call(e,r,1),!0)},wn.prototype.get=function(t){var e=this.__data__,r=kn(e,t);return r<0?void 0:e[r][1]},wn.prototype.has=function(t){return kn(this.__data__,t)>-1},wn.prototype.set=function(t,e){var r=this.__data__,n=kn(r,t);return n<0?r.push([t,e]):r[n][1]=e,this},bn.prototype.clear=function(){this.__data__={hash:new mn,map:new(yn||wn),string:new mn}},bn.prototype.delete=function(t){return jn(this,t).delete(t)},bn.prototype.get=function(t){return jn(this,t).get(t)},bn.prototype.has=function(t){return jn(this,t).has(t)},bn.prototype.set=function(t,e){return jn(this,t).set(t,e),this};var Fn=On((function(t){var e;t=null==(e=t)?"":function(t){if("string"==typeof t)return t;if(Bn(t))return gn?gn.call(t):"";var e=t+"";return"0"==e&&1/t==-1/0?"-0":e}(e);var r=[];return Qr.test(t)&&r.push(""),t.replace(Jr,(function(t,e,n,o){r.push(n?o.replace(Gr,"$1"):e||t)})),r}));function xn(t){if("string"==typeof t||Bn(t))return t;var e=t+"";return"0"==e&&1/t==-1/0?"-0":e}function On(t,e){if("function"!=typeof t||e&&"function"!=typeof e)throw new TypeError("Expected a function");var r=function(){var n=arguments,o=e?e.apply(this,n):n[0],i=r.cache;if(i.has(o))return i.get(o);var s=t.apply(this,n);return r.cache=i.set(o,s),s};return r.cache=new(On.Cache||bn),r}On.Cache=bn;var Tn=Array.isArray;function Pn(t){var e=Dn(t)?un.call(t):"";return"[object Function]"==e||"[object GeneratorFunction]"==e}function Rn(t){return"number"==typeof t&&t>-1&&t%1==0&&t<=$r}function Dn(t){var e=typeof t;return!!t&&("object"==e||"function"==e)}function In(t){return!!t&&"object"==typeof t}function Bn(t){return"symbol"==typeof t||In(t)&&"[object Symbol]"==un.call(t)}var Nn=function(t,e){return null!=t&&Sn(t,e,En)},Un=t=>{window.console&&"function"==typeof console.warn&&console.warn(t)};const Mn={},zn={};let qn=0;setInterval((()=>{const t=Object.keys(Mn),e=Date.now();t.forEach((t=>{Mn[t].expires<e&&delete Mn[t]}))}),3e4);var Ln={callback:(t,e,r)=>{const n=e.callback,{action:o}=e,i=e.options;return se.try((()=>{switch(o){case"run":if(Nn(zn,n))return zn[n].call(null,t,i);if(Nn(Mn,n))return zn[n]=Mn[n].fx,delete Mn[n],zn[n].call(null,t,i);throw Un("Attempted to run callback that does not exist or was not retained"),t.NotHandled("callback does not exist or was not retained");case"retain":if(Nn(Mn,n))return zn[n]=Mn[n].fx,delete Mn[n],n;throw Un("Attempted to retain callback that does not exist"),t.NotHandled("callback can no longer be retained");case"release":return Nn(zn,n)?(delete zn[n],null):(Un("Attempted to release callback that is not retained"),null);default:throw Un("Attempted an unknown callback action"),t.NotHandled("unknown callback action")}})).then(r)},serialize:t=>{const e="cb"+(qn+=1);return Mn[e]={fx:t,expires:Date.now()+12e4},{_callback:e}},reset:()=>{qn=0,Object.keys(Mn).forEach((t=>{delete Mn[t]})),Object.keys(zn).forEach((t=>{delete zn[t]}))}},Hn=1/0,$n=9007199254740991,Wn=17976931348623157e292,Vn=NaN,Kn="[object Arguments]",Qn="[object Function]",Jn="[object GeneratorFunction]",Gn="[object String]",Xn="[object Symbol]",Yn=/^\s+|\s+$/g,Zn=/^[-+]0x[0-9a-f]+$/i,to=/^0b[01]+$/i,eo=/^0o[0-7]+$/i,ro=/^(?:0|[1-9]\d*)$/,no=parseInt;function oo(t){return t!=t}function io(t,e){return function(t,e){for(var r=-1,n=t?t.length:0,o=Array(n);++r<n;)o[r]=e(t[r],r,t);return o}(e,(function(e){return t[e]}))}var so,ao,co=Object.prototype,lo=co.hasOwnProperty,uo=co.toString,ho=co.propertyIsEnumerable,po=(so=Object.keys,ao=Object,function(t){return so(ao(t))}),fo=Math.max;function yo(t,e){var r=go(t)||function(t){return function(t){return bo(t)&&mo(t)}(t)&&lo.call(t,"callee")&&(!ho.call(t,"callee")||uo.call(t)==Kn)}(t)?function(t,e){for(var r=-1,n=Array(t);++r<t;)n[r]=e(r);return n}(t.length,String):[],n=r.length,o=!!n;for(var i in t)!e&&!lo.call(t,i)||o&&("length"==i||vo(i,n))||r.push(i);return r}function _o(t){if(r=(e=t)&&e.constructor,n="function"==typeof r&&r.prototype||co,e!==n)return po(t);var e,r,n,o=[];for(var i in Object(t))lo.call(t,i)&&"constructor"!=i&&o.push(i);return o}function vo(t,e){return!!(e=null==e?$n:e)&&("number"==typeof t||ro.test(t))&&t>-1&&t%1==0&&t<e}var go=Array.isArray;function mo(t){return null!=t&&function(t){return"number"==typeof t&&t>-1&&t%1==0&&t<=$n}(t.length)&&!function(t){var e=wo(t)?uo.call(t):"";return e==Qn||e==Jn}(t)}function wo(t){var e=typeof t;return!!t&&("object"==e||"function"==e)}function bo(t){return!!t&&"object"==typeof t}var ko=function(t,e,r,n){var o;t=mo(t)?t:(o=t)?io(o,function(t){return mo(t)?yo(t):_o(t)}(o)):[],r=r&&!n?function(t){var e=function(t){if(!t)return 0===t?t:0;if((t=function(t){if("number"==typeof t)return t;if(function(t){return"symbol"==typeof t||bo(t)&&uo.call(t)==Xn}(t))return Vn;if(wo(t)){var e="function"==typeof t.valueOf?t.valueOf():t;t=wo(e)?e+"":e}if("string"!=typeof t)return 0===t?t:+t;t=t.replace(Yn,"");var r=to.test(t);return r||eo.test(t)?no(t.slice(2),r?2:8):Zn.test(t)?Vn:+t}(t))===Hn||t===-1/0){return(t<0?-1:1)*Wn}return t==t?t:0}(t),r=e%1;return e==e?r?e-r:e:0}(r):0;var i=t.length;return r<0&&(r=fo(i+r,0)),function(t){return"string"==typeof t||!go(t)&&bo(t)&&uo.call(t)==Gn}(t)?r<=i&&t.indexOf(e,r)>-1:!!i&&function(t,e,r){if(e!=e)return function(t,e,r,n){for(var o=t.length,i=r+(n?1:-1);n?i--:++i<o;)if(e(t[i],i,t))return i;return-1}(t,oo,r);for(var n=r-1,o=t.length;++n<o;)if(t[n]===e)return n;return-1}(t,e,r)>-1},Eo="[object Object]";var Co=Function.prototype,jo=Object.prototype,Ao=Co.toString,So=jo.hasOwnProperty,Fo=Ao.call(Object),xo=jo.toString,Oo=function(t,e){return function(r){return t(e(r))}}(Object.getPrototypeOf,Object);function To(t){return!!t&&"object"==typeof t}var Po=function(t){return!!t&&1===t.nodeType&&To(t)&&!function(t){if(!To(t)||xo.call(t)!=Eo||function(t){var e=!1;if(null!=t&&"function"!=typeof t.toString)try{e=!!(t+"")}catch(t){}return e}(t))return!1;var e=Oo(t);if(null===e)return!0;var r=So.call(e,"constructor")&&e.constructor;return"function"==typeof r&&r instanceof r&&Ao.call(r)==Fo}(t)},Ro=Object.prototype.toString,Do=Array.isArray;var Io=function(t){return"string"==typeof t||!Do(t)&&function(t){return!!t&&"object"==typeof t}(t)&&"[object String]"==Ro.call(t)},Bo=9007199254740991,No="[object Arguments]",Uo="[object Function]",Mo="[object GeneratorFunction]",zo="[object Symbol]",qo="object"==typeof e&&e&&e.Object===Object&&e,Lo="object"==typeof self&&self&&self.Object===Object&&self,Ho=qo||Lo||Function("return this")();function $o(t,e,r){switch(r.length){case 0:return t.call(e);case 1:return t.call(e,r[0]);case 2:return t.call(e,r[0],r[1]);case 3:return t.call(e,r[0],r[1],r[2])}return t.apply(e,r)}function Wo(t,e){for(var r=-1,n=e.length,o=t.length;++r<n;)t[o+r]=e[r];return t}var Vo=Object.prototype,Ko=Vo.hasOwnProperty,Qo=Vo.toString,Jo=Ho.Symbol,Go=Vo.propertyIsEnumerable,Xo=Jo?Jo.isConcatSpreadable:void 0,Yo=Math.max;function Zo(t,e,r,n,o){var i=-1,s=t.length;for(r||(r=ti),o||(o=[]);++i<s;){var a=t[i];e>0&&r(a)?e>1?Zo(a,e-1,r,n,o):Wo(o,a):n||(o[o.length]=a)}return o}function ti(t){return ri(t)||function(t){return function(t){return ni(t)&&function(t){return null!=t&&function(t){return"number"==typeof t&&t>-1&&t%1==0&&t<=Bo}(t.length)&&!function(t){var e=function(t){var e=typeof t;return!!t&&("object"==e||"function"==e)}(t)?Qo.call(t):"";return e==Uo||e==Mo}(t)}(t)}(t)&&Ko.call(t,"callee")&&(!Go.call(t,"callee")||Qo.call(t)==No)}(t)||!!(Xo&&t&&t[Xo])}function ei(t){if("string"==typeof t||function(t){return"symbol"==typeof t||ni(t)&&Qo.call(t)==zo}(t))return t;var e=t+"";return"0"==e&&1/t==-Infinity?"-0":e}var ri=Array.isArray;function ni(t){return!!t&&"object"==typeof t}var oi=function(t,e){return e=Yo(void 0===e?t.length-1:e,0),function(){for(var r=arguments,n=-1,o=Yo(r.length-e,0),i=Array(o);++n<o;)i[n]=r[e+n];n=-1;for(var s=Array(e+1);++n<e;)s[n]=r[n];return s[e]=i,$o(t,this,s)}}((function(t,e){return null==t?{}:function(t,e){return function(t,e,r){for(var n=-1,o=e.length,i={};++n<o;){var s=e[n],a=t[s];r(a,s)&&(i[s]=a)}return i}(t=Object(t),e,(function(e,r){return r in t}))}(t,function(t,e){for(var r=-1,n=t?t.length:0,o=Array(n);++r<n;)o[r]=e(t[r],r,t);return o}(Zo(e,1),ei))}));const ii=(t,e)=>{if(!t)return t;if(("url"===e||"icon"===e)&&"string"==typeof t&&0===t.indexOf("./"))return Lr(t.substr(2));const r={};switch(typeof t){case"object":return Array.isArray(t)?t.map(ii):(Object.keys(t).forEach((e=>{r[e]=ii(t[e],e)})),r);case"function":return Ln.serialize(t);default:return t}};var si=t=>/^[a-f0-9]{24}$/.test(t),ai=t=>/^[a-zA-Z0-9]{8}$/.test(t),ci=t=>-1!==["shared","private"].indexOf(t),li=t=>-1!==["board","card","member","organization"].indexOf(t);const ui={board:8192,card:4096,member:4096,organization:8192},hi={};function pi(t,e,r,n){const o=this,i={...r};o.setRequestQueue||(o.setRequestQueue=new Map);const s=`PUT:${t}:${e}`,{chain:a,size:c}=o.setRequestQueue.has(s)?o.setRequestQueue.get(s):{chain:se.resolve(),size:0},l=()=>o.get(t,e),u=a.then(l,l).then((t=>{const e=t||{},r=JSON.stringify(e),a=n(e);if(i.data=JSON.stringify(a),i.data===r)return se.resolve();if(i.data.length>ui[i.scope])throw new Error(`PluginData length of ${ui[i.scope]} characters exceeded. See: https://developers.trello.com/v1.0/reference#section-size-limit`);const c=o.requestWithContext("set",i);return c.finally((()=>{const t=o.setRequestQueue.get(s);1===t.size?o.setRequestQueue.delete(s):o.setRequestQueue.set({chain:t.chain,size:t.size-1})})),c}));return o.setRequestQueue.set(s,{chain:u,size:c+1}),u}hi.getContext=function(){return this.args[0].context},hi.isMemberSignedIn=function(){const t=this.getContext();return null!=t&&"notLoggedIn"!==t.member&&null!=t.member},hi.memberCanWriteToModel=function(t){if(!this.isMemberSignedIn())return!1;if("string"!=typeof t||!ko(["board","card","organization"],t))throw new Error("modelType must be one of: board, card, organization");const e=this.getContext();return null!=e&&null!=e.permissions&&"write"===e.permissions[t]},hi.requestWithContext=function(t,e){const r=e||{};return r.context="function"==typeof this.getContext?this.getContext():{},this.request(t,ii(r))},hi.getAll=function(){const t=this;return t.outstandingGetAllReq||(t.outstandingGetAllReq=t.requestWithContext("data").then((e=>{const r={};return Object.keys(e).forEach((t=>{r[t]={},Object.keys(e[t]).forEach((n=>{try{r[t][n]=JSON.parse(e[t][n])}catch(e){r[t][n]={}}}))})),t.outstandingGetAllReq=null,r})).catch((e=>{throw t.outstandingGetAllReq=null,e}))),t.outstandingGetAllReq},hi.get=function(t,e,r,n){const o=this;o.outstandingGetRequests||(o.outstandingGetRequests=new Map);let i="GET";const s={};if((si(t)||ai(t))&&(s.idCard=t,t="card",i="GET:"+s.idCard),!ci(e))throw new Error("Invalid value for visibility.");if(!li(t))throw new Error("Invalid value for scope.");return o.outstandingGetRequests.has(i)||o.outstandingGetRequests.set(i,o.requestWithContext("data",s)),o.outstandingGetRequests.get(i).then((s=>{let a={};if(s&&Nn(s,t)&&Nn(s[t],e))try{a=JSON.parse(s[t][e])}catch(t){}return o.outstandingGetRequests.delete(i),null==r?a||n:null!=a&&Nn(a,r)?a[r]:n})).catch((t=>{throw o.outstandingGetRequests.delete(i),t}))},hi.set=function(t,e,r,n){const o={scope:t,visibility:e};if(!ci(e))throw new Error("Invalid value for visibility.");if((si(t)||ai(t))&&(o.idCard=t,o.scope="card"),!li(o.scope))throw new Error("Invalid value for scope.");return pi.call(this,t,e,o,(t=>{const e={...t};return"object"==typeof r?Object.keys(r).forEach((t=>{e[t]=r[t]})):e[r]=n,e}))},hi.remove=function(t,e,r){const n={scope:t,visibility:e};let o=r;if((si(t)||ai(t))&&(n.idCard=t,n.scope="card"),Array.isArray(o)||(o=[r]),o.some((t=>"string"!=typeof t)))return Un("t.remove function takes either a single string or an array of strings for which keys to remove"),null;if(!li(n.scope))throw new Error("Invalid value for scope.");if(!ci(e))throw new Error("Invalid value for visibility.");return pi.call(this,t,e,n,(t=>{const e={...t};return o.forEach((t=>{delete e[t]})),e}))},hi.safe=t=>String(null==t?"":t).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#39;").replace(/`/g,"&#x60;"),hi.arg=function(t,e){const r=this.args[1];return r&&"object"==typeof r&&Nn(r,t)?r[t]:e},hi.signUrl=function(t,e){const r=this.getContext(),n=encodeURIComponent(JSON.stringify({secret:this.secret,context:r,locale:window.locale,args:e}));return t.includes("#")?(Un("Power-Up signing url that already has a hash. This will remove the existing hash."),`${t.slice(0,t.indexOf("#"))}#${n}`):`${t}#${n}`},hi.navigate=function(t){return t&&"object"==typeof t&&"string"==typeof t.url?this.requestWithContext("navigate",t):se.reject(new Error("Invalid or missing url provided in options object"))},hi.showCard=function(t){return t&&"string"==typeof t?this.requestWithContext("showCard",{idCard:t}):se.reject(new Error("Invalid idCard provided"))},hi.hideCard=function(){return this.requestWithContext("hideCard")},hi.alert=function(t){const e=oi(t,["message","duration","display"]),r=e.message;return!Io(r)||r.length<1||r.length>140?se.reject(new Error("Alert requires a message of 1 to 140 characters")):this.requestWithContext("alert",e)},hi.hideAlert=function(){return this.requestWithContext("hideAlert")};hi.popup=function(t){if(!(this.getContext().el||t&&t.mouseEvent))return Un("Unable to open popup. Context missing target element or a mouseEvent was not provided. This usually means you are using the wrong t param, and should instead use the one provided to the callback function itself, not the capability handler. If you are within an iframe, then make sure you pass the mouse event."),se.reject(new Error("Context missing target element and no mouse event provided"));const e={title:t.title};if(t&&t.mouseEvent){const{mouseEvent:r}=t,{clientX:n,clientY:o}=r;if(!ue(n)||!ue(o))return se.reject(new Error("Invalid mouseEvent was provided"));{let t=n,i=o;if(0===t&&0===i){if(!r.target||!r.target.getBoundingClientRect)return se.reject(new Error("Invalid mouseEvent was provided"));const e=r.target.getBoundingClientRect();t=e.left,i=e.top}e.pos={x:t,y:i}}}t&&"function"==typeof t.callback&&(e.callback=t.callback);try{if(t.url&&"string"==typeof t.url)e.content={type:"iframe",url:this.signUrl(Lr(t.url),t.args),width:t.width,height:t.height};else if(t.items)e.content=(t=>{let e;if(Array.isArray(t.items)||"function"==typeof t.items)e=t.items;else{if("object"!=typeof t.items)throw new Error("Unsupported items type for popup. Must be an array, object, or function");e=Object.keys(t.items).map((e=>{const r=t.items[e];return"function"==typeof r?{text:e,callback:r}:r&&"function"==typeof r.callback?l({text:e},r):{text:e}}))}return{items:e,type:"list",search:t.search}})(t);else if("confirm"===t.type)e.content=(t=>{if("string"!=typeof t.message||"string"!=typeof t.confirmText)throw new Error("Confirm popups must have a message and confirmText");if("function"!=typeof t.onConfirm)throw new Error("Confirm popup requires onConfirm function");if("function"==typeof t.onCancel&&"string"!=typeof t.cancelText)throw new Error("Confirm popup requires cancelText to support onCancel function");const e={type:"confirm",message:t.message,confirmStyle:t.confirmStyle||"primary",confirmText:t.confirmText,onConfirm:t.onConfirm};return"string"==typeof t.cancelText&&(e.cancelText=t.cancelText),"function"==typeof t.onCancel&&(e.onCancel=t.onCancel),e})(t);else{if("datetime"!==t.type&&"date"!==t.type)return se.reject(new Error("Unknown popup type requested"));delete e.callback,e.content=(t=>{if("function"!=typeof t.callback)throw new Error("Date popups must have a callback function");const e={type:t.type,callback:t.callback};if(t.date&&"function"==typeof t.date.toISOString&&(e.date=t.date.toISOString()),t.minDate&&"function"==typeof t.minDate.toISOString&&(e.minDate=t.minDate.toISOString()),t.maxDate&&"function"==typeof t.maxDate.toISOString&&(e.maxDate=t.maxDate.toISOString()),e.minDate&&e.maxDate&&e.minDate>e.maxDate)throw new Error("Date popup maxDate must come after minDate if specified");return e})(t)}}catch(t){return se.reject(t)}return this.requestWithContext("popup",e)},hi.overlay=function(t){Un("overlay() has been deprecated. Please use modal() instead. See: https://trello.readme.io/v1.0/reference#t-modal");const e={};return t.url&&(e.content={type:"iframe",url:this.signUrl(Lr(t.url),t.args),inset:t.inset}),this.requestWithContext("overlay",e)},hi.boardBar=function(t){if(!t||!t.url||"string"!=typeof t.url)throw new Error("BoardBar options requires a valid url");if(t.actions&&!Array.isArray(t.actions))throw new Error("BoardBar actions property must be an array");let e;t.accentColor&&(e=fe(t.accentColor));const r={content:{actions:t.actions||[],callback:t.callback,accentColor:e,height:t.height||200,resizable:t.resizable||!1,title:t.title,type:"iframe",url:this.signUrl(Lr(t.url),t.args)}};return this.requestWithContext("board-bar",r)},hi.modal=function(t){if(!t||!t.url||"string"!=typeof t.url)throw new Error("Modal options requires a valid url");if(t.actions&&!Array.isArray(t.actions))throw new Error("Modal actions property must be an array");let e;t.accentColor&&(e=fe(t.accentColor));const r={content:{actions:t.actions||[],callback:t.callback,accentColor:e,fullscreen:t.fullscreen||!1,height:t.height||400,title:t.title,type:"iframe",url:this.signUrl(Lr(t.url),t.args)}};return this.requestWithContext("modal",r)},hi.updateModal=function(t){if(!t)return se.resolve();const{accentColor:e,actions:r,fullscreen:n,title:o}=t;if(!(e||r||n||o))return se.resolve();if(t.url)throw new Error("Updating Modal url not allowed");if(t.callback)throw new Error("Unable to update callback. You can set onBeforeUnload to run code before Modal close: https://developer.mozilla.org/en-US/docs/Web/API/WindowEventHandlers/onbeforeunload");if(r&&!Array.isArray(r))throw new Error("Modal actions property must be an array");const i={content:oi(t,["actions","accentColor","fullscreen","title"])};return e&&(i.content.accentColor=fe(e)),this.requestWithContext("update-modal",i)},hi.hide=function(){return Un("hide() handler has been deprecated. Please use closePopup()"),this.requestWithContext("close-popup")},hi.closePopup=function(){return this.requestWithContext("close-popup")},hi.back=function(){return this.requestWithContext("pop-popup")},hi.hideOverlay=function(){return Un("hideOverlay() handler has been deprecated. Please use closeOverlay()"),this.requestWithContext("close-overlay")},hi.closeOverlay=function(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};Un("overlay() has been deprecated. Please use modal() instead. See: https://trello.readme.io/v1.0/reference#t-modal");const e={inset:t.inset};return this.requestWithContext("close-overlay",e)},hi.hideBoardBar=function(){return Un("hideBoardBar() handler has been deprecated. Please use closeBoardBar()"),this.requestWithContext("close-board-bar")},hi.closeBoardBar=function(){return this.requestWithContext("close-board-bar")},hi.closeModal=function(){return this.requestWithContext("close-modal")},hi.sizeTo=function(t){let e;if(Io(t)){const r=document.querySelector(t);if(!r)return se.reject(new Error("No elements matched sizeTo query selector: "+t));r.style.overflow="hidden",e=Math.ceil(Math.max(r.scrollHeight,r.getBoundingClientRect().height))}else if(Po(t)){const r=t;r.style.overflow="hidden",e=Math.ceil(Math.max(r.scrollHeight,r.getBoundingClientRect().height))}else{if(!(ue(t)&&t>0))return se.reject(new Error("Invalid argument. Must be a selector, element, or positive number. Was: "+t));e=t}return e?this.requestWithContext("resize",{height:e}):se.reject(new Error(`Unable to determine desired height for ${t} computed ${e}`))},hi.localizeKey=Mr,hi.localizeKeys=zr,hi.localizeNode=qr,hi.card=function(){for(var t=arguments.length,e=new Array(t),r=0;r<t;r++)e[r]=arguments[r];return this.requestWithContext("card",{fields:e})},hi.cards=function(){for(var t=arguments.length,e=new Array(t),r=0;r<t;r++)e[r]=arguments[r];return this.requestWithContext("cards",{fields:e})},hi.list=function(){for(var t=arguments.length,e=new Array(t),r=0;r<t;r++)e[r]=arguments[r];return this.requestWithContext("list",{fields:e})},hi.lists=function(){for(var t=arguments.length,e=new Array(t),r=0;r<t;r++)e[r]=arguments[r];return this.requestWithContext("lists",{fields:e})},hi.member=function(){for(var t=arguments.length,e=new Array(t),r=0;r<t;r++)e[r]=arguments[r];return this.requestWithContext("member",{fields:e})},hi.board=function(){for(var t=arguments.length,e=new Array(t),r=0;r<t;r++)e[r]=arguments[r];return this.requestWithContext("board",{fields:e})},hi.organization=function(){for(var t=arguments.length,e=new Array(t),r=0;r<t;r++)e[r]=arguments[r];return this.requestWithContext("organization",{fields:e})},hi.attach=function(t){if(!this.memberCanWriteToModel("card"))throw new Error("User lacks write permission on card.");return this.requestWithContext("attach-to-card",t)},hi.requestToken=function(t){if(!this.isMemberSignedIn())throw new Error("No active member in context.");return this.requestWithContext("request-token",t)},hi.authorize=(t,e)=>{let r;const n=S.randomId(),o=e||{};if("string"==typeof t)r=t;else{if("function"!=typeof t)throw Un("authorize requires a url or function that takes a secret and returns a url"),new Error("Invalid arguments passed to authorize");r=t(n)}let i=()=>!0;o.validToken&&"function"==typeof o.validToken&&(i=o.validToken);const s=o.width||800,a=o.height||600,c=["width=",s,",height=",a,",left=",window.screenX+Math.floor((window.outerWidth-s)/2),",top=",window.screenY+Math.floor((window.outerHeight-a)/2)].join(""),l=(t,e)=>{const r=window.open(t,"authorize",e);return"function"==typeof o.windowCallback&&o.windowCallback(r),r};return new se((e=>{window.addEventListener("storage",(t=>{const e=r=>{if("token"===r.key&&r.newValue&&i(r.newValue)){try{localStorage.removeItem("token")}catch(t){}window.removeEventListener("storage",e,!1),delete window.authorize,t(r.newValue)}};return e})(e),!1),"function"==typeof t?new S({Promise:se,local:window,remote:l(r,c),targetOrigin:o.targetOrigin||"*",secret:n,handlers:{value(t,r){r&&r.token&&i(r.token)&&(this.stop(),e(r.token))}}}):(window.authorize=t=>{t&&i(t)&&(delete window.authorize,e(t))},l(r,c))}))},hi.storeSecret=function(t,e){if(!this.isMemberSignedIn())throw new Error("No active member in context.");const r=this.getContext().member,n=this;return Ne.sha256Digest(`${r}:${t}`).then((t=>n.get("member","private","aescbc").then((t=>t||Ne.generateAESCBCKey().then((t=>Ne.exportAESCBCKeyToRaw(t))))).then((r=>Ne.importAESCBCKeyFromRaw(r).then((o=>{const i=Ne.generateInitVector();return Ne.encryptSecret(i,o,e).then((e=>{const o=`${de(i)};${e}`;return window.localStorage.setItem(t,o),n.set("member","private","aescbc",r).then((()=>({key:t,value:o})))}))}))))))},hi.loadSecret=function(t){if(!this.isMemberSignedIn())throw new Error("No active member in context.");const e=this.getContext().member,r=this;return Ne.sha256Digest(`${e}:${t}`).then((t=>window.localStorage.getItem(t))).then((t=>t?r.get("member","private","aescbc").then((e=>e?Ne.importAESCBCKeyFromRaw(e).then((e=>{const r=t.substring(0,t.indexOf(";")),n=t.substring(t.indexOf(";")+1),o=ye(r);return Ne.decryptSecret(o,e,n)})):null)):null))},hi.clearSecret=function(t){if(!this.isMemberSignedIn())throw new Error("No active member in context.");const e=this.getContext().member;return Ne.sha256Digest(`${e}:${t}`).then((t=>(window.localStorage.removeItem(t),null)))},hi.notifyParent=(t,e)=>{const r=e||{};window.parent.postMessage(t,r.targetOrigin||"*")},hi.confetti=function(t){const e={};if(t&&ue(t.clientX)&&ue(t.clientY)&&Po(t.target)){const r=t,{clientX:n,clientY:o}=r;let i=n,s=o;if(0===i&&0===s){if(!r.target||!r.target.getBoundingClientRect)return se.reject(new Error("Invalid mouseEvent was provided"));const t=r.target.getBoundingClientRect();i=t.left+r.target.offsetWidth/2,s=t.top+r.target.offsetHeight/2}e.pos={x:i,y:s}}else{let r;if(Po(t))r=t;else if(Io(t)&&(r=document.querySelector(t),!r))return se.reject(new Error("No elements matched confetti query selector: "+t));if(r){const t=r.getBoundingClientRect();e.pos={x:t.left+r.offsetWidth/2,y:t.top+r.offsetHeight/2}}}return this.requestWithContext("confetti",e)};const fi=new Map;hi.jwt=function(t){if(!this.isMemberSignedIn())return se.reject(new Error("No active member in context."));const e=!0===(null==t?void 0:t.card);if(e&&!this.getContext().card)return se.reject(new Error("No card in context"));let r="";if("string"==typeof(null==t?void 0:t.state)){if(t.state.length>2048)return se.reject(new Error("State parameter must be a string of at most 2048 characters"));r=t.state}else if(null!=(null==t?void 0:t.state))return se.reject(new Error("State parameter must be a string of at most 2048 characters"));const n=[this.getContext().board,e?this.getContext().card:"",r].join(":");if(fi.has(n))return fi.get(n);const o=this.requestWithContext("jwt",{state:r,includeCard:e});return o.finally((()=>{fi.delete(n)})),fi.set(n,o),fi.get(n)};var di=(t,e)=>{const r=e||{};return new(r.io||S)({Promise:se,local:window,remote:window.parent,targetOrigin:r.targetOrigin||"https://trello.com",secret:r.secret,strict:!0,handlers:t,hostHandlers:r.hostHandlers,helpfulStacks:"boolean"!=typeof r.helpfulStacks||r.helpfulStacks,Sentry:r.Sentry})},yi=Or("restApi",["AuthDeniedError","AuthNotReadyError","ApiNotConfiguredError"]);const _i={makeWebCall:function(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];if(!this.t)throw new yi.AuthNotReadyError("The API helper cannot be used from this context. This probably means that you are attemping to use it inside your iframe connector, but outside a capability handler. For more, http://developers.trello.com/v1.0/reference#api-client-availability.");if("function"!=typeof this.t[t])throw new yi.AuthNotReadyError("This method cannot be used in this context. This probably means that you are attemping to use it inside your iframe connector, but outside a capability handler. For more, http://developers.trello.com/v1.0/reference#api-client-availability.");return this.t[t](...e)}},vi=t=>/^[a-z0-9]{64}$/.test(t);_i.registerMessageHandler=function(t){return new se(((e,r)=>{let n,o;n=setInterval((()=>{t&&t.closed&&(clearInterval(n),r(new yi.AuthDeniedError))}),500);const i=n=>{n.origin===window.location.origin&&n.source===t&&(o(),n.source.close(),n.data&&vi(n.data)?e(n.data):r(new yi.AuthDeniedError))},s=t=>{t.key===this.tokenStorageKey&&(o(),this.fetchAndStoreToken().then((t=>{t?e(t):r(new yi.AuthDeniedError)})))};o=()=>{window.removeEventListener("storage",s,!1),window.removeEventListener("message",i,!1),clearInterval(n)},window.addEventListener("message",i,!1),window.addEventListener("storage",s,!1)}))},_i.storeToken=function(t){return this.makeWebCall("set",["member","private",this.tokenStorageKey,t]).then((()=>t))},_i.checkForToken=function(){let t;try{t=this.localStorage.getItem(this.tokenStorageKey)}catch(t){}return vi(t)?t:null},_i.fetchAndStoreToken=function(){const t=this.checkForToken();return t?this.storeToken(t).then((()=>(this.localStorage.removeItem(this.tokenStorageKey),t))):se.resolve(null)},_i.getToken=function(){return this.fetchAndStoreToken().then((t=>t||this.makeWebCall("get",["member","private",this.tokenStorageKey])))},_i.clearToken=function(){try{this.localStorage.removeItem(this.tokenStorageKey)}catch(t){}return this.makeWebCall("remove",["member","private",this.tokenStorageKey])},_i.popupConfig=function(){return`width=550,height=725,left=${window.screenX+(window.outerWidth-550)/2},top=${window.screenY+(window.outerHeight-725)/2}`},_i.showAuthPopup=function(t){let{expiration:e="never",scope:r="read",returnUrl:n=null}=t;const o={name:this.appName,key:this.appKey,expiration:e,scope:r,callback_method:"fragment",response_type:"fragment"};o.return_url=n||window.location.href;let i=this.authBase()+"/authorize?";return i+=Object.keys(o).map((t=>`${t}=${encodeURIComponent(o[t])}`)).join("&"),window.open(i,"authpopup",this.popupConfig())},_i.authorize=function(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return new se(((e,r)=>{const n=this.showAuthPopup(t);this.getToken().then((t=>{t&&(n.close(),e(t))})),this.registerMessageHandler(n).then(e).catch(r)})).then((t=>this.storeToken(t)))},_i.isAuthorized=function(){return this.getToken().then((t=>vi(t)))},_i.checkAndStoreToken=function(){const t=window.location.hash.match(/token=(.+)?/);if(t&&2===t.length){const e=vi(t[1])?t[1]:"";try{this.localStorage.setItem(this.tokenStorageKey,e)}catch(t){}try{window.opener&&window.opener.postMessage(e,window.location.origin)}catch(t){}window.setTimeout((()=>window.close()),500)}else this.fetchAndStoreToken()};class gi{constructor(t){let{t:e,appKey:r,appName:n,apiOrigin:o="https://api.trello.com",authOrigin:i="https://trello.com",localStorage:s=window.localStorage,tokenStorageKey:a="trello_token"}=t;this.appKey=r,this.appName=n,this.apiOrigin=o,this.authOrigin=i,this.t=e,this.localStorage=s,this.tokenStorageKey=a}init(){this.checkAndStoreToken()}apiBase(){return this.apiOrigin+"/1"}authBase(){return this.authOrigin+"/1"}}Object.keys(_i).forEach((t=>{gi.prototype[t]=_i[t]}));class mi{constructor(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this.handlers={},this.io=null,this.NotHandled=S.NotHandled,this.options=e,e.Sentry&&e.Sentry.configureScope((t=>{t.setTag("powerupjs_version","1.22.4")}));const r=this;Object.keys(t).forEach((e=>{r.handlers[e]=function(){for(var r=arguments.length,n=new Array(r),o=0;o<r;o++)n[o]=arguments[o];const i=this;return se.try((()=>t[e].apply(i,n))).then(ii)}})),this.handlers.callback=function(t,e){return Ln.callback.call(this,t,e,ii)};["requestWithContext","getAll","get","set","remove","safe","localizeKey","localizeKeys","localizeNode","board","cards","lists","member","organization"].forEach((t=>{Nn(hi,t)&&(r[t]=hi[t])}))}connect(){const t=this,e=di(this.handlers,l(this.options,{hostHandlers:l(hi,{getRestApi(){if(!t.restApi)throw new yi.ApiNotConfiguredError("To use the API helper, make sure you specify appKey and appName when you call TrelloPowerup.initialize. For more, https://developers.trello.com/v1.0/reference#rest-api.");return t.restApi.t=this,t.restApi}})}));return this.io=e,e.request("initialize",Object.keys(this.handlers)).then((t=>(e.secret=t.secret,window.locale=t.locale||"en",this.options.Sentry&&"object"==typeof t&&this.options.Sentry.configureScope((e=>{e.setTag("locale",window.locale),e.setTag("trello_version",t.version||"unknown"),t.member&&e.setUser({id:t.member})})),Ur(window.locale,this.options).then((()=>e.request("ready")))))).then((()=>e))}request(t,e){return this.io.request(t,e)}init(){return this.options.appKey&&this.options.appName?(this.restApi=new gi({t:this,appKey:this.options.appKey,appName:this.options.appName,apiOrigin:this.options.apiOrigin,authOrigin:this.options.authOrigin,localStorage:this.options.localStorage,tokenStorageKey:this.options.tokenStorageKey}),this.connect().tap((()=>this.restApi.init()))):((this.options.appKey||this.options.appName)&&Un("Both appKey and appName must be included to use the API. See more https://developers.trello.com/v1.0/reference#rest-api."),this.connect())}}mi.prototype.NotHandled=S.NotHandled;let wi=null;var bi,ki=(t,e)=>{if(!wi)try{wi=JSON.parse(decodeURIComponent(window.location.hash.replace(/^#/,"")))}catch(t){Un("Power-Up unable to parse url hash, perhaps you needed a t.signUrl(url)?"),wi={}}return Nn(wi,t)?wi[t]:e};class Ei{constructor(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.io=null,this.args=[{context:ki("context",t.context),secret:ki("secret",t.secret)}].concat(ki("args")),this.secret=ki("secret",t.secret),this.options=t,window.locale=ki("locale","en"),this.i18nPromise=Ur(window.locale,t),this.secret||(Un("Power-Up iframe initialized without a secret. Requests to Trello will not work."),Un("If this is an attachment-section or card-back-section make sure you call t.signUrl on the urls you provide."))}init(){this.initSentry(),this.connect(),this.initApi()}connect(){const t={callback(t,e){return Ln.callback.call(this,t,e,ii)}};this.io=di(t,l(this.options,{secret:ki("secret"),hostHandlers:hi}))}request(t,e){return this.io.request(t,e)}render(t){if("function"!=typeof t)throw new TypeError("Argument passed to render must be a function");const e=this;e.onMessage&&window.removeEventListener("message",e.onMessage,!1),e.onMessage=r=>{r.source===window.parent&&"render"===r.data&&e.i18nPromise.then((()=>{t()}))},window.addEventListener("message",e.onMessage,!1)}initApi(){this.options.appKey&&this.options.appName?(this.restApi=new gi({t:this,appKey:this.options.appKey,appName:this.options.appName,apiOrigin:this.options.apiOrigin,authOrigin:this.options.authOrigin,localStorage:this.options.localStorage,tokenStorageKey:this.options.tokenStorageKey}),this.restApi.init()):(this.options.appKey||this.options.appName)&&Un("Both appKey and appName must be included to use the API. See more at https://developers.trello.com/v1.0/reference#rest-api.")}getRestApi(){if(!this.restApi)throw new yi.ApiNotConfiguredError("To use the API helper, make sure you specify appKey and appName when you call TrelloPowerUp.iframe. See more at https://developers.trello.com/v1.0/reference#rest-api");return this.restApi}initSentry(){if(this.options.Sentry){const t=ki("context",this.options.context);this.options.Sentry.configureScope((e=>{e.setTag("locale",ki("locale","en")),e.setTag("powerupjs_version","1.22.4"),t&&"object"==typeof t&&(e.setTag("trello_version",t.version||"unknown"),t.member&&e.setUser({id:t.member}),t.board&&e.setTag("idBoard",t.board),t.permissions&&Object.keys(t.permissions).forEach((r=>{e.setExtra(r+"_permission",t.permissions[r])})))}))}}}Ei.prototype.NotHandled=S.NotHandled;for(const t in hi)Nn(hi,t)&&(Ei.prototype[t]=hi[t]);(bi=window.Element.prototype).matches=bi.matches||bi.mozMatchesSelector||bi.msMatchesSelector||bi.oMatchesSelector||bi.webkitMatchesSelector,bi.closest=bi.closest||function(t){let e=this;for(;e&&!e.matches(t);)e=e.parentElement;return e};class Ci{constructor(){this.version="1.22.4",this.CallbackCache=Ln,this.PostMessageIO=S,this.Promise=se,this.util={colors:{getHexString:pe,namedColorStringToHex:fe},convert:{bytesToHexString:de,hexStringToUint8Array:ye},crypto:Ne,initLocalizer:Ur,i18n:{localizeKey:Mr,localizeKeys:zr,localizeNode:qr},makeErrorEnum:Or,relativeUrl:Lr},this.restApiError=yi,this.initialize=this.initialize.bind(this),this.iframe=this.iframe.bind(this)}initialize(t,e){return null!=this.iframeConnector&&Un("Cannot call TrelloPowerUp.initialize() from a secondary iframe where you have already called TrelloPowerUp.iframe(). TrelloPowerUp.initialize() should only be called from your index connector page, and should not include a call to TrelloPowerUp.iframe()"),null!=this.indexConnector?(Un("Warning: calling TrelloPowerUp.initialize() more than once will have no effect. It is expected that you call it only once on your index connector."),this.indexConnector):(this.indexConnector=new mi(t,e),this.indexConnector.init(),this.indexConnector)}iframe(t){return null!=this.indexConnector&&Un("Cannot call TrelloPowerUp.iframe() from your index connector where you call TrelloPowerUp.initialize(). TrelloPowerUp.iframe() is only used for secondary iframes you may create or request from Trello during the Power-Up lifecycle."),null!=this.iframeConnector||(this.iframeConnector=new Ei(t),this.iframeConnector.init()),this.iframeConnector}}window.TrelloPowerUp=new Ci}));
//# sourceMappingURL=power-up.min.js.map
